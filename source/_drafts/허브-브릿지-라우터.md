---
title: '허브, 브릿지, 라우터'
date: 2019-07-18 00:57:39
tags:
---

OSI 게층과 인터넷 장비의 관계 : https://songsunghan.tistory.com/13?category=126600

맥 어드레스로 데이터를 보냄  
처음엔 맥 어드레스를 알아내기 위해 ARP(IP로 맥 어드레스를 찾는 행위) Request를 브로드캐스트로 보냄  
브로드캐스트를 받은 컴퓨터는 인터럽트가 걸리고, CPU에서 해당 요청을 처리해야함  
ARP로 맥 어드레스를 얻은 컴퓨터는 맥 어드레스를 통해 통신한다  

ARP를 보낼 떄 응답하는 PC가 없다면(내부 네트워크 대역에 대한 요청이 아니라면)  
라우터가 자신의 맥 어드레스를 보내면서 응답한다  
이후 source PC는 destination IP를 세팅한 채 라우터의 맥 어드레스로 데이터를 보낸다  

케이블의 경우 최대 전송거리 제한이 있음  
리피터 : 중간에서 들어온 데이터를 다른 곳으로 그대로 전달해주는 역할  
랜은 허브로 구성, 이더넷 허브의 경우 CSMA/CD  
허브끼리 연결하면 콜리전 도메인이 계속 커지게 됨  
허브도 속도를 가지고, 랜카드도 속도를 가지고, 케이블도 속도를 가짐  
한순간에는 한대의 PC만이 데이터를 보낼 수 있고, 속도도 하나의 장비밖에 사용하지 못함  

스위치는 포트별로 콜리전 도메인이 나뉘어져있고, 데이터 전송 에러 복구 등의 기능 또한 가지고 있다  
하나의 서버로만 요청을 보내는 상태에서 스위치를 사용해봐야 이득이 별로 없다  
> 어느 한순간에는 하나의 장비만 통신이 가능하기 떄문이다  

브릿지는 포트별 콜리전 도메인까지는 아니지만 콜리전 도메인을 나눠주는 기능을 가지고 있음  
스위치나 브릿지도 콜리전 도메인을 나누기는 하지만 결국 브로드캐스트 

라우터는 시리얼 인터페이스(외부)와 이더넷 인터페이스(내부)가 있다  

네트워크 주소로 라우터가 네트워크를 찾아준다  

허브,브릿지,스위치 내에서는 어떤 IP를 쓰든 상관없음  
어쩌피 자기네들끼리만 통신할 것이기 때문에, 해당 콜리전 도메인 내에서만 고유한 IP면 된다  
그러나 결국 인터넷이라는 것을 사용하기 위해선 외부로 통신을 해야하고, 네트워크는 특성상 어느 시점에서도 두 IP가 겹치는 경우가 있으면 통신을 할 수 없다    
그러므로 IP들은 각각의 구분을 나누는 규칙이 필요하게 된 것이고, 그 중에서도 내부 통신만을 위해 사용할 부분인 사설 IP 대역을 따로 분리해놓은 것이다  

허브 2개를 합치면 그냥 콜리전 도메인이 커지게됨  

스위치 아래 N개의 허브를 연결하면 허브들은 각각 콜리전 도메인이 나눠지게 된다  

스위치나 허브에 IP를 배정하지 않아도 통신에는 지장이 없으나, 관리를 위해 배정한다(펌웨어를 사용하기 위해)  

콜리전 도메인이 나눠지든 뭐 어쨋든간에, 허브(브릿지, 스위치) 끼리 연결한곳은 하나의 브로드캐스트 도메인이 되고, IP는 고유해야 한다  

---

<https://songsunghan.tistory.com/12?category=126600>  

라우티드 프로토콜(TCP/IP, AppleTalk 등)이 라우터에 들어가고, 라우팅 프로토콜(RIP, IGRP 등)에 의해 다른 곳으로 전달된다  
이더넷 인터페이스는 무조건 같은 네트워크 대역이어야 한다? 결국 라우터가 스위치등을 포함하기 때문에?  
라우팅 테이블의 대체적 형태  
```
I 144.253.0.0 via 133.3.32.2 // 어째서..?
I 131.108.33.0 via 131.108.16.2
C 131.108.12.0 is directly connected Ethernet0
```  

desination IP를 가진 데이터 패킷이 라우터의 맥 어드레스로 들어왔을 때, 라우터는 이를 어떻게 처리할까?  
라우터는 이를 받아서 라우팅 테이블을 참조한 뒤, 자신의 이더넷 네트워크면 ARP를 보내고, 아니라면 상대편 라우터로 보낸다 일까?  

상대편 라우터의 시리얼 인터페이스와 IP주소를 맞추어야 한다?  
라우터에서 인터페이스가 달라지는 것은 네트워크가 달라지는 것을 의미한다  
라우터끼리의 연결은 시리얼 인터페이스를 연결하는 것  

라우터의 시리얼 인터페이스와 DSU를 연결하고, DSU와 전용선을 연결한다  

라우터는 3계층, 허브나 스위치는 2계층이다(OSI 기준)  
허브나 스위치는 연결된 장비들에게 모든 장비들에게 브로드캐스팅을 하고 수신층 장비에서 자신에게 오는 데이터를 수신받는 방식  
이는 일정 규모가 넘어가면 매우 비효율적인 방식이다  
라우터는 라우팅 알고리즘이라는 것을 통해 다른 네트워크로 데이터를 넘겨주는 방식이다  
다른 네트워크라하면 다른 라우터를 말한다  
라우터끼리 계속해서 정보를 주고받으며 서로 라우팅 테이블을 갱신한다(특정 상황에서 정적 라우팅을 사용하기도 하지만 지금은 너무 많은 라우터들이 있으므로 거의 불가능함)  

라우팅 테이블에 대해 찾아보자  
<https://kwongyo.tistory.com/23>  
라우터에서 다른 주소를 찾아갈떄는, 어떻게 가는가?  
결국에 시리얼 인터페이스끼리 연결되어 있어야하지 않는가?  
그런데 어떻게 라우터에서 여러개의 경로로 갈수가 있는건지? 시리얼 인터페이스 하나만 연결되어 있을테면 거기로만 가야하는게 아닌지?  

라우터 또한 컴퓨터이다  
라우팅 테이블은 메모리에 올라가며, NVRAM을 이용하므로 재부팅하면 다시 메모리에 올라가므로, 데이터가 유실되지 않음  