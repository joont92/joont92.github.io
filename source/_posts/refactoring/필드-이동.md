---
title: 필드 이동
date: 2019-05-03 23:25:37
tags:
    - 리팩토링
    - move field
---

> 어떤 필드가 자신이 속한 클래스보다 다른 클래스에서 더 많이 사용될 때는  
> 대상 클래스 안에 새 필드를 선언하고 그 필드 참조 부분을 전부 새 필드 참조로 수정하자  

# 동기
- 어떤 필드가 자신이 속한 클래스보다 다른 클래스에 있는 메서드를 더 많이 참조한다면, 그 필드를 옮기는 것을 생각해봐야 한다
- 만약 클래스 추출을 할 경우 필드 추출이 우선이고, 메서드 추출이 그 다음이다

# 방법
책의 예제에는 잘 안나와있는데, 난 아래와 같이 이해했다  

1. A 클래스안에서 B 클래스의 `field` 필드를 자주 이용한다면 B 클래스의 `field`를 A 클래스로 옮겨버릴 수 있다  
    ```java
    class A {
        private B b;
        public void someMethod1() {
            // do something
            b.getField();
            // do something
        }

        public void someMethod2() {
            // do something
            b.getField(); // 이런식으로 자주 사용된다면
            // do something
        }

        public void someMethod3() {
            // do something
            b.getField(); // 이런식으로 자주 사용된다면
            // do something
        }
    }

    class B {
        private int field;
        // getter/setter

        public void someMethod() {
            // do something;
            field;
            // do something;
        }
    }
    ```

2. 필드 이동으로 인한 변경을 최소화 하기 위해 이동 대상 클래스 필드(B의 field)에 `필드 자체 캡슐화`를 적용한다
    ```java
    class A {
        // ...
    }

    class B { 
        private int field;
        // getter/setter

        public void someMethod() {
            // do something;
            getField(); // 필드 자체 캡슐화
            // do something;
        }
    }
    ```

3. B 클래스의 `field`를 A 클래스로 옮긴다
    ```java
    class A {
        private int field;

        public void someMethod1() {
            // do something
            field;
            // do something
        }

        public void someMethod2() {
            // do something
            field;
            // do something
        }

        public void someMethod3() {
            // do something
            field;
            // do something
        }
    }
    ```

4. B 클래스에서 `field`를 삭제한다. `필드 자체 캡슐화`가 적용되어 있으므로 변경을 최소화 할 수 있다  
    ```java
    class B {
        private A a;

        public int getField() {
            return a.getField();
        }

        public void someMethod() {
            // do something;
            getField(); // 변경 없음
            // do something;
        }
    }
    ```

<!-- more -->