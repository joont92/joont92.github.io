<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="기록은 기억의 연장선">
<meta property="og:url" content="https://joont92.github.io/page/5/index.html">
<meta property="og:site_name" content="기록은 기억의 연장선">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="기록은 기억의 연장선">



  <link rel="alternate" href="/feed.xml" title="기록은 기억의 연장선" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://joont92.github.io/page/5/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>기록은 기억의 연장선</title>
  




  <script async src="//www.googletagmanager.com/gtag/js?id=UA-110551662-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-110551662-1');
    }
  </script>









  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">기록은 기억의 연장선</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">더 많은 것을 기억하기 위해 기록합니다</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/joont92" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/TDD로-화폐-개발하기-2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/TDD로-화폐-개발하기-2/" class="post-title-link" itemprop="url">[tdd] TDD로 화폐 개발하기(2)</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-13 21:57:34" itemprop="dateCreated datePublished" datetime="2019-04-13T21:57:34+00:00">2019-04-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/TDD로-화폐-개발하기-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/TDD로-화폐-개발하기-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>이번 예제는 아래의 것들을 설명해주고 있다</p>
<ul>
<li>큰 단위의 테스트를 작게 접근하는 방법</li>
<li>테스트를 기반으로 수월하게 리팩토링 하는 방법</li>
<li>중복되는 두 클래스의 형태를 동일하게 바꾼 뒤 상위 클래스로 올리기(push up)</li>
<li>해결법이 보이지 않을때 다시 되돌아가서 시도하는 방법</li>
</ul>
<h1 id="큰-단위의-작업에-접근하기"><a class="markdownIt-Anchor" href="#큰-단위의-작업에-접근하기"></a> 큰 단위의 작업에 접근하기</h1>
<p>이제 처음에 복잡해보여서 시도하지 못했던 <code>$5 + 10CHF = $10(환율이 2:1일 경우)</code> 을 작성해보자<br>
알다시피 이 요구사항의 경우 테스트 단위가 크다<br>
<strong>우리는 이렇게 큰 테스트를 공략할 수 없으므로 진전을 나타낼 수 있는 작은 테스트를 만들어야 한다</strong></p>
<p>일단 뭐 잘 모르겠고, 다시 보니 Dollar와 비슷하게 Franc이 필요해보이니 추가해보자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FrancTest</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Franc five = <span class="keyword">new</span> Franc(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    assertThat(five.times(<span class="number">2</span>)).isEqaulTo(<span class="keyword">new</span> Franc(<span class="number">10</span>));</span><br><span class="line">    assertThat(five.times(<span class="number">3</span>)).isEqaulTo(<span class="keyword">new</span> Franc(<span class="number">15</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquality</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Franc(<span class="number">5</span>)).isEqualTo(<span class="keyword">new</span> Franc(<span class="number">5</span>));</span><br><span class="line">    assertThat(<span class="keyword">new</span> Franc(<span class="number">5</span>)).isNotEqualTo(<span class="keyword">new</span> Franc(<span class="number">6</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>알다시피 이 테스트를 빨리 초록막대에 도달하게 해야한다<br>
가장 빠른 방법은 Dollar를 복사히여 Franc을 만드는 것이다(뭐 테스트도 복사한 마당에…)</p>
<p>복사 붙여넣기라니, 굉장히 이상해보일 수 있다<br>
하지만 알다시피 5단계(중복제거)에서 다 수정하면 된다<br>
<strong>4단계까지는 설계보다 속도가 더 중요하고, 그것을 위해선 어떤 죄악도 저지를 수 있다</strong></p>
<p><strong>물론 5단계에서 이 죄악을 수습하지 않고는 다음 단계로 나아갈 수 없다</strong><br>
여기서 적절한 설계를 하고, 돌아가게 만들고, 올바르게 만들어야 한다</p>
<h1 id="죄를-수습하자"><a class="markdownIt-Anchor" href="#죄를-수습하자"></a> 죄를 수습하자</h1>
<p><strong>중복을 제거하기 위한 방법은 뭐가 있을까? 두 클래스의 공통된 상위 클래스를 추출해보는건 어떨까?</strong></p>
<p>먼저 Dollar 부터 적용시켜보자</p>
<ol>
<li>
<p>먼저 Dollar와 Franc의 공통 클래스로 <code>Money</code>라는 애를 만들고, 이를 상속받게 한다</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dollar</span> <span class="keyword">extends</span> <span class="title">Money</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> amount;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>amount 변수를 Money로 올리고(protected), Dollar에서 amount 변수를 제거할 수 있다</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> amount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dollar</span> <span class="keyword">extends</span> <span class="title">Money</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>이제 equals 부분을 Money로 올려볼 수 있다</p>
<ul>
<li>
<p>우선 equals 부분을 Money에 맞춰 변경하고</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    Money money = (Money) object;</span><br><span class="line">    <span class="keyword">return</span> amount == money.amount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Money 클래스로 올린다</p>
</li>
<li>
<p>Dollar에서 equals는 삭제한다</p>
</li>
</ul>
</li>
</ol>
<p><strong>각 과정을 진행할때마다 계속 테스트를 돌리면서 진행했고, 수월하게 리팩토링 할 수 있었다</strong><br>
이제 Franc도 똑같이 진행할 것이다<br>
아까 DollerTest를 복사해서 FranTest를 만들어줬기 때문에 Franc 또한 Dollar 처럼 수월하게 리팩토링이 가능하다</p>
<blockquote>
<p>만약 Franc에 대한 테스트를 추가하지 않았다면 라팩토링 전에 추가해주는 것이 좋다<br>
<strong>(이 외에도 있어야 할 것 같은 테스트가 있다면 작성해줘야 한다)</strong></p>
<p>그렇게 하지 않으면 리팩토링 하다가 결국 뭔가 꺠트릴 것이고,<br>
리팩토링에 대해 안좋은 느낌을 갖게 되고,<br>
리팩토링을 덜 하게 되고,<br>
코드의 질이 떨어지게 되고,<br>
해고당한다(!!!)</p>
</blockquote>
<h1 id="또-한번-찾아온-불길한-느낌"><a class="markdownIt-Anchor" href="#또-한번-찾아온-불길한-느낌"></a> 또 한번 찾아온 불길한 느낌</h1>
<p>우리는 앞 단계에서 배웠다<br>
부작용에 대한 혐오감이 생기는 경우, 즉시 테스트를 추가해서 결과를 확인해봐야 한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquality</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Dollar(<span class="number">5</span>)).isNotEqualTo(<span class="keyword">new</span> Franc(<span class="number">5</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>테스트가 실패한다!<br>
그래도 불안감을 눈으로 확인해보니 마음이 한결 편해졌다<br>
이 부분은 객체의 클래스를 비교함으로써 간단하게 구현가능하다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    Money money = (Money) object;</span><br><span class="line">    <span class="keyword">return</span> amount == money.amount</span><br><span class="line">        &amp;&amp; getClass() == money.getClass();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>간단하게 테스트를 통과시켰다<br>
클래스 타입 비교로 통화를 비교한다는게 조금 그렇긴하지만 일단은 그냥 넘어간다</p>
<blockquote>
<p>더 많은 동기가 있기 전에는 더 많은 설계를 하지 않는것이 좋다</p>
</blockquote>
<h1 id="하위클래스를-없애기-위한-시도-직접-참조-제거"><a class="markdownIt-Anchor" href="#하위클래스를-없애기-위한-시도-직접-참조-제거"></a> 하위클래스를 없애기 위한 시도 - 직접 참조 제거</h1>
<p>상위 클래스 추출이 성공했으니, 남아있는 <code>times()</code> 메서드의 리턴타입도 상위 클래스로 변경해도 괜찮겠다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dollar</span> </span>&#123;</span><br><span class="line">    <span class="function">Money <span class="title">times</span><span class="params">(<span class="keyword">int</span> multiplier)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount * multiplier);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Franc</span> </span>&#123;</span><br><span class="line">    <span class="function">Money <span class="title">times</span><span class="params">(<span class="keyword">int</span> multiplier)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Franc(amount * multiplier);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이쯤되니 두 하위 클래스의 형태가 많이 비슷해졌다<br>
바로 제거하는 테크를 타고 싶긴하지만, 그렇게 한번에 큰 step을 밟는것은 좀 위험하고 TDD에도 맞지 않으니 단계적으로 진행하도록 한다</p>
<p><strong>첫번째 단계는 <code>하위클래스에 대한 직접적인 참조들을 제거</code>하는 것이다</strong><br>
<strong><code>new Dollar(5)</code> 와 같은 강력한 직접 참조들을 먼저 제거해보자</strong><br>
직접 참조를 제거하는 방법으로 팩토리 메서드를 써보면 좋을 것 같다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DollarTest</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquality</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(Money.dollar(<span class="number">5</span>)).isEqualTo(<span class="keyword">new</span> Dollar(<span class="number">5</span>));</span><br><span class="line">    assertThat(Money.dollar(<span class="number">5</span>)).isNotEqualTo(<span class="keyword">new</span> Dollar(<span class="number">6</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar dollar = Money.dollar(<span class="number">5</span>);</span><br><span class="line">    assertThat(Money.dollar(<span class="number">10</span>)).isEqualTo(dollar.times(<span class="number">2</span>));</span><br><span class="line">    assertThat(Money.dollar(<span class="number">15</span>)).isEqualTo(dollar.times(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>팩토리 메서드는 아래와 같이 만든다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> Dollar <span class="title">dollar</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>times()</code>의 직접 참조도 제거하고,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Money.dollar(amount * multiplier);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Dollar에 대한 참조까지 제거해주자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Money money = Money.dollar(<span class="number">5</span>);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Money에 times가 없기 때문에 오류가 발생한다<br>
이를 위해 추상 클래스를 하나 추가해준다(더 먼저해야 했을수도 있었다)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Money</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Money <span class="title">times</span><span class="params">(<span class="keyword">int</span> multiplier)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 완벽하게 new Dollar()를 팩토리 메서드로 대체할 수 있다</p>
<blockquote>
<p>하위 클래스의 존재를 테스트 메서드에서 분리(decoupling)헀으므로, 이제 테스트에 영향을 주지 않고 상속구조를 마음껏 변경할 수 있게 된다<br>
테스트 메서드뿐 아니라 모든 클라이언트 코드에서도 이런식으로 결합도를 낮추면 변화에 유연해진다</p>
</blockquote>
<p>이제 Franc에 대해서도 똑같이 작업해준다</p>
<p>똑같이 변경해놓고 보니, <code>DollarTest</code>와 <code>FrancTest</code>의 테스트들의 형태가 매우 중복되어 보인다<br>
나는 이 시점에서 두 테스트를 합쳐서 <code>MoneyTest</code>로 만들었다</p>
<blockquote>
<p>이런식으로 하위클래스가 분리되다보면 몇몇 테스트가 불필요한 여분의 것이 된다</p>
</blockquote>
<h1 id="하위클래스를-없애기-위한-시도-추상화"><a class="markdownIt-Anchor" href="#하위클래스를-없애기-위한-시도-추상화"></a> 하위클래스를 없애기 위한 시도 - 추상화</h1>
<p><code>times()</code>의 모양을 같게 하려면 <code>Money.dollar</code>와 <code>Money.franc</code>을 같게 만들어야한다<br>
그러므로 둘을 추상화 할수있는 뭔가가 필요하다<br>
<code>통화</code>라는 개념을 도입하면 뭔가 하위 클래스 제거에 좀 더 가까워질 것 같다</p>
<p>먼저 통화 개념에 대한 테스트를 작성해본다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCurrency</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(Money.dollar(<span class="number">1</span>).currency()).isEqualTo(<span class="string">"USD"</span>);</span><br><span class="line">    assertThat(Money.franc(<span class="number">1</span>).currency()).isEqualTo(<span class="string">"CHF"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>통화를 인스턴스 변수에 저장하고 메서드에서 그걸 반환해주면 될 것 같다<br>
(좀 더 step by step으로 갈수도 있긴 하지만 바로 떠오르니깐 뭐)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="keyword">private</span> Strnig currency;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Dollar</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.amount = amount;</span><br><span class="line">    currency = <span class="string">"USD"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">currency</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> currency;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Franc</span></span><br><span class="line"><span class="keyword">private</span> String currency;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Franc</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.amount = amount;</span><br><span class="line">    currecny = <span class="string">"CHF"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">currency</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> currency;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>변수 선언과 currency() 메서드가 동일하므로, 이를 위로 올릴(push up) 수 있다(야호!)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Money</span></span><br><span class="line"><span class="keyword">protected</span> String currency;</span><br><span class="line"></span><br><span class="line"><span class="function">String <span class="title">currency</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> currency;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Dollar와 Franc의 생성자에서 currency 세팅하는 부분을 파라미터로 받게하면<br>
두 생성자의 형태가 똑같아질수 있을 것 같다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Dollar</span><span class="params">(<span class="keyword">int</span> amount, String currency)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.amount = amount;</span><br><span class="line">    <span class="keyword">this</span>.currency = currency;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Franc도 동일</span></span><br></pre></td></tr></table></figure>
<p>이렇게 바꿨더니 아래의 메서드가 깨진다(ㅠㅠ)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Dollar <span class="title">dollar</span><span class="params">(Integer amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Franc <span class="title">franc</span><span class="params">(Integer amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Franc(amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>우린 하위클래스의 형태를 맞추고 push up을 진행하는 중이었는데, 구조상의 변경으로 인해 이런식의 상황이 종종 발생할떄가 있다<br>
이럴때는, 이걸 지금 고쳐야할까, 아니면 나중에 고쳐야할까?<br>
교리상은 하던일을 중단하지 않고 다 끝낸 다음에 고치는것이 맞지만, 이정도의 짧은 중단은 그냥 받아들이고 가도 괜찮다</p>
<blockquote>
<p>중요한것은 <strong>하던 일을 중단하고 다른 일을 하는 상태에서 또 그 일을 중단하면 안된다는 것</strong>이다(Jim Coplien)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Money</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Money <span class="title">dollar</span><span class="params">(<span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount, <span class="string">"USD"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Franc도 동일</span></span><br></pre></td></tr></table></figure>
<p>컴파일 에러를 해결했으니 위로 올리자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Money</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Money</span><span class="params">(<span class="keyword">int</span> amount, String currency)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.amount = amount;</span><br><span class="line">    <span class="keyword">this</span>.currency = currency;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Dollar</span><span class="params">(<span class="keyword">int</span> amount, String currency)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(amount, currency);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Franc</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Franc</span><span class="params">(<span class="keyword">int</span> amount, String currency)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(amount, currency);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>생성자를 바로 제거하고 싶었으나 아직 Money가 추상 클래스라 불가능하다<br>
times를 먼저 손봐야한다</p>
<blockquote>
<p>이런식으로 단계적으로 밟아가는 과정이 답답할수도 있다<br>
중요한 것은 <strong>이런식으로 일해야 한다는 것이 아니라, 이런식으로 일할수도 있어야 한다</strong>는 것이다<br>
종종걸음 step이 답답하면 조금 보폭을 늘려도 되고, 성큼성큼 걷는것이 불안하면 조금 보폭을 줄이면 된다<br>
<strong>TDD란 조종해나가는 과정이다. 올바른 보폭이란 존재하지 않는다</strong></p>
</blockquote>
<h2 id="다시-돌아가서-생각을"><a class="markdownIt-Anchor" href="#다시-돌아가서-생각을"></a> 다시 돌아가서 생각을…</h2>
<p><code>times()</code> 메서드를 바로 위로 올려보려고 했는데, 생김새가 좀 막막하다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Money.dollar(amount * multiplier);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Franc</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Money.franc(amount * multiplier);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>잘 모르겠으니 팩토리 메서드를 다시 생성자로 돌려보자<br>
<strong>(이렇게 방법이 없을땐 잠시 후퇴해서 보는것도 방법이다)</strong><br>
(+ 여기서 currency는 클래스에 있는 값을 바로 쓰도록 한다. 굳이 파라미터로 또 전달할 필요 없다)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount * multiplier, currency);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Franc</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Franc(amount * multiplier, currency);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이렇게 돌려놓으니 좀 보이는것 같다<br>
Dollar나 Franc으로 생성하느냐는 별로 중요한 것 같지가 않다. 어쩌피 currency가 있는데 굳이 뭐하러.<br>
저걸 Money로 바꿔보자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dollar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Money(amount * multiplier, <span class="string">"CHF"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Franc</span></span><br></pre></td></tr></table></figure>
<p>Money를 구현 클래스로 만들어야 하므로, 추상 메서드를 제거한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Money</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Money <span class="title">times</span><span class="params">(Integer multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이렇게 하고 테스트를 돌렸더니, Money 클래스가 Dollar 클래스가 아니라는둥, Money 클래스가 Franc 클래스가 아니라는 둥의 결과가 출력된다<br>
이 말인 즉, 문제는 equals에 있었던 것이다. 비교해야 될 것은 클래스가 아니라 currency이다</p>
<p>이를 위해 추가적인 테스트가 작성되어야하는데, 현재 빨간막대 상태이다<br>
빨간 막대 상태일때는 테스트를 추가하지 않는 것이 좋다<br>
좀 보수적이긴 하지만, 다시 Dollar와 Franc의 <code>new Money</code>를 <code>new Dollar, new Franc</code>으로 돌린다</p>
<p>그리고 테스트를 작성한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDifference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Money(<span class="number">5</span>, <span class="string">"USD"</span>)).isEqualTo(<span class="keyword">new</span> Dollar(<span class="number">5</span>, <span class="string">"USD"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 테스트를 통과시키기 위해 equals를 변경한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    Money money = (Money) obj;</span><br><span class="line">    <span class="keyword">return</span> amount.equals(money.amount)</span><br><span class="line">        &amp;&amp; currency().equals(money.currency());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>테스트가 통과하니, 다시 times의 <code>new Dollar, new Franc</code>을 <code>new Money</code>로 바꾼다<br>
이 테스트 또한 잘 통과하고, 이제 times의 형태가 같아졌으니 push up 할 수 있다!!</p>
<p><strong>뒤로 돌아가지 않았다면 이처럼 팩토리 메서드 사용을 제거할 수 있다는 사실을 알기 힘들었을 것이다</strong></p>
<h1 id="하위클래스를-없애기-위한-시도-나머지-부분-제거"><a class="markdownIt-Anchor" href="#하위클래스를-없애기-위한-시도-나머지-부분-제거"></a> 하위클래스를 없애기 위한 시도 - 나머지 부분 제거</h1>
<p>이제 두 클래스에 남은건 생성자밖에 없다<br>
단지 생성자 때문에 하위클래스를 남겨놓을수는 없으니, 제거하는 것이 좋다<br>
유일하게 남아있는 하위 클래스 직접 참조인 <code>정적 팩토리 메서드</code>를 수정하자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Money <span class="title">dollar</span><span class="params">(Integer amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Money(amount, <span class="string">"USD"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Money <span class="title">franc</span><span class="params">(Integer amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Money(amount, <span class="string">"CHF"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 완벽하게 제거하…려고 하는데, 생각해보니 아직 직접 참조가 한군데 더 남아있다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDifference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Money(<span class="number">5</span>, <span class="string">"USD"</span>)).isEqualTo(<span class="keyword">new</span> Dollar(<span class="number">5</span>, <span class="string">"USD"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>보니까 이 테스트는 이미 다른 테스트에서 수행하고 있는 작업들이다. 제거하자.<br>
이로 인해 최종적으로 하위 클래스를 전부 제거할 수 있게된다!!</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/TDD로-화폐-개발하기-2/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/TDD로-화폐-개발하기-1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/TDD로-화폐-개발하기-1/" class="post-title-link" itemprop="url">[tdd] TDD로 화폐 개발하기(1)</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-06 22:57:35" itemprop="dateCreated datePublished" datetime="2019-04-06T22:57:35+00:00">2019-04-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/TDD로-화폐-개발하기-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/TDD로-화폐-개발하기-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>이번 예제는 아래의 것들을 설명해주고 있다</p>
<ul>
<li>처음 테스트를 작성하고, 주기를 완성하는 방법</li>
<li>불길한 예감을 추가해서 테스트를 단단하게 하는 방법</li>
<li>프로덕션 구현을 어떻게 해야할지 모르겠을 때 삼각측량을 이용하는 방법</li>
<li>코드나 테스트가 리팩토링되면서 감춰도 되는 변수를 private 으로 감추는 방법</li>
</ul>
<h1 id="tdd-주기-만들기"><a class="markdownIt-Anchor" href="#tdd-주기-만들기"></a> TDD 주기 만들기</h1>
<p><strong>요구사항(작업해야 할 목록)을 나열한다</strong></p>
<blockquote>
<ul>
<li>통화가 다른 두 금액을 더한 금액(주어진 환율에 맞게)을 결과로 얻을 수 있어야한다</li>
<li>어떤 금액을 어떤 수에 곱한 금액을 결과로 얻을 수 있어야한다</li>
</ul>
</blockquote>
<p>요구사항을 보고 할일 목록을 작성한다</p>
<blockquote>
<ul>
<li>$5 + 10CHF = $10(환율이 2:1일 경우)</li>
<li>$5 x 2 = $10</li>
<li>Dollar 부작용(side effect?)</li>
<li>등등등</li>
</ul>
</blockquote>
<p><strong>이중 간단한 것 부터 시작한다</strong></p>
<ul>
<li>복잡한 것은 작게 나눠서 시작하던지, 아예 손을 대지 않는것이 좋다</li>
<li>여기서는 <code>$5 x 2 = $10</code> 부터 시작한다</li>
</ul>
<p>필요할 테스트를 생각해보고, 작성한다</p>
<ul>
<li>이때 <strong>테스트할 메서드의 완벽한 인터페이스(형태)에 대해 상상해보는 것</strong>이 좋다</li>
<li>가능한 최선의 API에서 시작해서 거꾸로 작업하는 것이 애초부터 일을 복잡하고 보기 흉하며 <code>현실적</code>이게 하는 것보다 낫다</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar five = <span class="keyword">new</span> Dollar(<span class="number">5</span>);</span><br><span class="line">    five.times(<span class="number">2</span>);</span><br><span class="line">    assertThat(five.amount).isEqaulTo(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Dollar 클래스, 내부 메서드들이 구현되지 않았기 때문에 컴파일부터 실패하므로, 이를 해결한다</p>
<ul>
<li>Dollar 클래스 생성</li>
<li>생성자 생성</li>
<li>times(int) 생성</li>
<li>amount 필드 생성  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> amount;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>컴파일만 될 수 있게 최소한의 구현만 해서, <strong>expected/actual 을 반환하는 형태가 되도록 빨리 만든다</strong></p>
</blockquote>
<p>현재 상태에서는 <code>exptected : 10, actual : 0</code> 을 반환하며 테스트가 실패하지만, 이것도 진척이다(정확히 만족시켜야 할 상황을 알게되기 때문이다)<br>
<strong>이제 스텁구현(끔찍한 죄악!)을 통해 테스트를 만족시킨다</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> amount = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p>테스트가 통과하니, 이제 리팩토링(중복 제거)해야한다<br>
10이라는 숫자는 사실 초기값과 곱하고자 하는 수가 같이 들어가있는, 중복 데이터이다<br>
이를 분리한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> amount = <span class="number">5</span> * <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>그리고 뭐… 이렇게 저렇게해서 아래와 같이 진행한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// constructor</span></span><br><span class="line">Dollar(<span class="keyword">int</span> amount) &#123;</span><br><span class="line">    <span class="keyword">this</span>.amount = amount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">times</span><span class="params">(<span class="keyword">int</span> multiplier)</span> </span>&#123;</span><br><span class="line">    amount *= multiplier;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>단계들이 굉장히 작다고 느껴질 수 있는데,<br>
<strong>TDD의 핵심은 작은 단계를 밟아야 한다는 것이 아니라, 이런 작은 단계를 밟을 능력을 갖추어야 한다는 것이다</strong><br>
작은 단계로 작업하는 방법을 배우면, 저절로 적절한 크기의 단계로 작업할 수 있게 된다<br>
<strong>하지만 큰 단계로만 작업했다면, 더 작은 단계가 적절한 경우에 대해 결코 알지 못하게 된다</strong></p>
</blockquote>
<p>위 과정에서 볼 수 있는 일반적인 TDD의 주기는 아래와 같다</p>
<ol>
<li>테스트를 작성한다
<ul>
<li>메서드 형태가 어떤식으로 나타나길 원하는지 생각해본다</li>
</ul>
</li>
<li>실행 가능하게 만든다
<ul>
<li>다른 무엇보다도 중요한 것은 빨리 초록 막대를 보는 것이다</li>
<li>여기서 어떠한 죄악을 저질러도 상관없다
<ul>
<li>만약 깔끔하고 단순한 해법이 명백히 보인다면 그것을 입력한다</li>
<li>굳이 돌아갈 필요는 없다</li>
</ul>
</li>
</ul>
</li>
<li>올바르게 만든다
<ul>
<li>이제 시스템이 작동하므로(초록 막대!) 그 전에 저질렀던 죄악을 수습해야 한다</li>
<li>죄악을 수습하는 과정은 대부분 중복 제거이다</li>
</ul>
</li>
</ol>
<p><strong>우리의 목적은 동작하는 깔끔한 코드를 얻는 것이다</strong><br>
하지만 이는 최고의 프로그래머들도 도달하기 힘든 목표이고, 우리같은 일반적인 사람들은 거의 불가능한 일이다<br>
그래서 분할하여 정복(Divide and Conquer)를 사용하는 것이다<br>
일단 <code>작동하는</code> 부분을 먼저 해결하고, <code>깔끔한 코드</code> 부분을 해결하는 것이다</p>
<blockquote>
<p>아키텍쳐 주도 개발과 정 반대다</p>
</blockquote>
<h1 id="뭔가-이상한-것-같은데"><a class="markdownIt-Anchor" href="#뭔가-이상한-것-같은데"></a> 뭔가 이상한 것 같은데?</h1>
<p><strong>뭔가 기존 코드에 사이드 이펙트가 있는 것 같으니, 빠르게 테스트를 추가해서 확인해보자!!</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar five = <span class="keyword">new</span> Dollar(<span class="number">5</span>);</span><br><span class="line">    five.times(<span class="number">2</span>);</span><br><span class="line">    assertThat(five.amount).isEqaulTo(<span class="number">10</span>);</span><br><span class="line">    five.times(<span class="number">3</span>);</span><br><span class="line">    assertThat(five.amount).isEqaulTo(<span class="number">15</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>테스트가 실패한다. 알다시피 times 수행때마다 내부 amount가 변경되기 떄문이다<br>
times() 메서드에서 매번 새로운 객체를 반환하게 하면 이 문제를 해결가능할 것 같다</p>
<blockquote>
<p>근데 이렇게 변경하려니, 프로덕션 코드와 테스트 코드가 둘 다 변경되어야 한다<br>
뭔가 죄를 저지른듯한 기분이지만, 괜찮다<br>
<strong>어떤 구현이 올바른지에 대한 우리 추측이 완벽하지 못한 것과 마찬가지로, 올바른 인터페이스에 대한 추측 역시 절대 완벽하지 못하기 때문이다. 괜찮다.</strong></p>
</blockquote>
<p>테스트를 변경하자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar five = <span class="keyword">new</span> Dollar(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    Dollar product = five.times(<span class="number">2</span>);</span><br><span class="line">    assertThat(product.amount).isEqaulTo(<span class="number">10</span>);</span><br><span class="line">    product = five.times(<span class="number">3</span>);</span><br><span class="line">    assertThat(product.amount).isEqaulTo(<span class="number">15</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>그리고 올바르다고 생각되는 코드를 넣고, 테스트를 돌린다<br>
(지금은 운이 좋아 명백히 올바른 코드가 떠올랐지만, 바로 떠오르지 않을떄는 스텁으로 구현한다)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Dollar <span class="title">times</span><span class="params">(<span class="keyword">int</span> multiplier)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Dollar(amount * multiplier);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이처럼 <strong>느낌(부작용에 대한 혐오감)을 테스트로 변환하는 것은 TDD의 일반적인 주제</strong>이다<br>
<strong>이런 작업을 오래 할수록 느낌(미적 판단)을 테스트로 담아내는 것에 점점 익숙해지게 된다</strong></p>
<h1 id="삼각측량을-이용한-vo-구현"><a class="markdownIt-Anchor" href="#삼각측량을-이용한-vo-구현"></a> 삼각측량을 이용한 VO 구현</h1>
<p>구현해놓고 보니, <code>new Dollar(5)</code>와 <code>new Dollar(5)</code>가 같아야 할 것 같다<br>
테스트를 작성한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquality</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Dollar(<span class="number">5</span>)).isEqualTo(<span class="keyword">new</span> Dollar(<span class="number">5</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>빠르게 통과시켜보자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>알다시피 이는 끔찍한 죄악이다<br>
얼른 수정해야하는데, 어떻게 구현해야할지 잘 모르겠다(사실은 여기는 너무 간단해서 잘 알지만, 뭔가 복잡한 코드라고 생각해보자)<br>
여기서 삼각측량을 이용해서 답을 도출해낼 수 있다</p>
<blockquote>
<p>삼각측량은 어떤 한 점의 좌표와 거리를 삼각형의 성질을 이용하여 알아내는 방법이다<br>
간단하게 말해 <strong>2개를 통해 나머지 1개를 알아내는 것</strong> 이다</p>
</blockquote>
<p>테스트에 삼각측량을 도입해본다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEquality</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertThat(<span class="keyword">new</span> Dollar(<span class="number">5</span>)).isEqualTo(<span class="keyword">new</span> Dollar(<span class="number">5</span>));</span><br><span class="line">    assertThat(<span class="keyword">new</span> Dollar(<span class="number">5</span>)).isNotEqualTo(<span class="keyword">new</span> Dollar(<span class="number">6</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>amount 5를 가진 Dollar와 amount 6을 가진 Dollar는 같아서는 안된다<br>
amount를 대상으로 비교하면 될 것 같다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    Dollar dollar = (Dollar) obj;</span><br><span class="line">    <span class="keyword">return</span> amount == dollar.amount;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// null이나 다른 객체에 대한 검증도 필요하지만  </span></span><br><span class="line"><span class="comment">// 당장은 필요하지 않으므로, 간단히 어디에 메모만 해두고 넘어간다</span></span><br></pre></td></tr></table></figure>
<p>보다시피 <strong>2개의 테스트를 이용해 올바른 프로덕션 코드를 알아냈다</strong></p>
<blockquote>
<p>사실상 위의 equals 처럼 시작부터 일반적인 해법이 보일 경우 그냥 그 방법대로 구현하면 된다<br>
이 방법은 <strong>설계를 어떻게 할지 떠오르지 않을떄 사용해보면 조금 다른 방향에서 생각해볼 기회를 제공해주는 역할을 한다</strong></p>
</blockquote>
<h1 id="테스트-리팩토링"><a class="markdownIt-Anchor" href="#테스트-리팩토링"></a> 테스트 리팩토링</h1>
<p><strong>Dollar의 동치성을 구현하고 기존 테스트를 보니, 테스트가 그것을 정확히 얘기해주고 있지 않는것 같다</strong><br>
바꿔주자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar five = <span class="keyword">new</span> Dollar(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    Dollar product = five.times(<span class="number">2</span>);</span><br><span class="line">    assertThat(product).isEqaulTo(<span class="keyword">new</span> Dollar(<span class="number">10</span>));</span><br><span class="line">    product = five.times(<span class="number">3</span>);</span><br><span class="line">    assertThat(product).isEqaulTo(<span class="keyword">new</span> Dollar(<span class="number">15</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>불필요한 임시변수(product)를 인라인 시키는 리팩토링을 실시한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMultiplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dollar five = <span class="keyword">new</span> Dollar(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    assertThat(five.times(<span class="number">2</span>)).isEqaulTo(<span class="keyword">new</span> Dollar(<span class="number">10</span>));</span><br><span class="line">    assertThat(five.times(<span class="number">3</span>)).isEqaulTo(<span class="keyword">new</span> Dollar(<span class="number">15</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 amount 변수는 Dollar 에서 밖에 사용하지 않으니 private으로 선언한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> amount;</span><br></pre></td></tr></table></figure>
<p>위 과정에서 우리는 <code>위험한 상황을 만들었다</code>라는 점을 인지해야 한다<br>
<strong>Dollar에 대한 동치성 테스트(testEquality)가 실패하면 곱하기 테스트(testMultiplication) 역시 실패하게 된다는 점이다(테스트간 의존)</strong><br>
이것은 TDD를 하면서 적극적으로 관리해야할 위험 요소이다</p>
<blockquote>
<p>근데 뭐 어떻게 하라는지는 딱히 알려주고 있진 않네…</p>
</blockquote>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/TDD로-화폐-개발하기-1/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/aws/AWS-프리티어-free-tier-과금/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/aws/AWS-프리티어-free-tier-과금/" class="post-title-link" itemprop="url">[aws] AWS 프리티어(free-tier) 과금</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-04 12:38:25" itemprop="dateCreated datePublished" datetime="2019-04-04T12:38:25+00:00">2019-04-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/aws/" itemprop="url" rel="index"><span itemprop="name">aws</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/aws/AWS-프리티어-free-tier-과금/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="aws/AWS-프리티어-free-tier-과금/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>어제 밤에 갑자기 AWS에서 29달러 정도가 결제되어서 급하게 확인했더니, 프리티어 기간이 끝나서 과금이 되었었다… 아놔…<br>
그래서 그 내용을 정리하고자 한다</p>
<h1 id="프리티어"><a class="markdownIt-Anchor" href="#프리티어"></a> 프리티어?</h1>
<p>AWS는 가입시 1년간 특정 리소스들을 무료로 사용할 수 있는 <code>프리 티어</code> 권한을 가질 수 있다<br>
프리티어에서 1년간 무료로 사용가능한 리소스들은 아래와 같다<br>
<a href="https://aws.amazon.com/ko/free/?awsf.Free%20Tier%20Typeasdasds=categories%2312monthsfree&amp;awsm.page-all-free-tier=2" rel="external nofollow noopener noreferrer" target="_blank">https://aws.amazon.com/ko/free/?awsf.Free Tier Typeasdasds=categories%2312monthsfree&amp;awsm.page-all-free-tier=2</a></p>
<h1 id="프리티어인지-확인하는-법"><a class="markdownIt-Anchor" href="#프리티어인지-확인하는-법"></a> 프리티어인지 확인하는 법</h1>
<p><code>AWS 로그인 - 내 결제 대시보드</code> 로 접속한다</p>
<ol>
<li><code>청구서</code> 탭에서 날짜 드롭박스를 보고 언제 가입했는지 알 수 있다. 여기서 1년이 아직 안 지났는지를 체크해보면 된다.</li>
<li>대시보드 홈에서 <code>경고 및 알람</code> 부분에 free tier 관련 내용이 써져있으면 아직 free tier라는 의미이다<br>
<a href="https://docs.aws.amazon.com/ko_kr/awsaccountbilling/latest/aboutv2/free-tier-eligibility.html" rel="external nofollow noopener noreferrer" target="_blank">https://docs.aws.amazon.com/ko_kr/awsaccountbilling/latest/aboutv2/free-tier-eligibility.html</a></li>
</ol>
<h1 id="과금을-해결하는법"><a class="markdownIt-Anchor" href="#과금을-해결하는법"></a> 과금을 해결하는법</h1>
<p>프리티어 기간이 지났으면(혹은 프리티어라도 일정 수준 넘으면 과금될 수 있음) 과금이 될 리소스를 정리해야함<br>
위의 1년간 무료로 사용할 수 있는 리소스와 아래 정보들을 조합해서 과금 대상인 리소스들을 다 정리해야함<br>
<a href="https://docs.aws.amazon.com/ko_kr/awsaccountbilling/latest/aboutv2/checklistforunwantedcharges.html" rel="external nofollow noopener noreferrer" target="_blank">https://docs.aws.amazon.com/ko_kr/awsaccountbilling/latest/aboutv2/checklistforunwantedcharges.html</a></p>
<h2 id="내-경우"><a class="markdownIt-Anchor" href="#내-경우"></a> 내 경우</h2>
<p>EC2와 RDS에서 과금이 되고 있었음<br>
RDS 들어가서 해당 데이터베이스를 삭제시켰고, EC2에서 인스턴스를 terminated 시켰음</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/aws/AWS-프리티어-free-tier-과금/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/객체지향-스타일/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/객체지향-스타일/" class="post-title-link" itemprop="url">[tdd] 객체지향 스타일</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-30 12:12:10" itemprop="dateCreated datePublished" datetime="2019-03-30T12:12:10+00:00">2019-03-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/객체지향-스타일/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/객체지향-스타일/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>우리는 작성하기 쉬운 코드보다는 유지보수하기 쉬운 코드를 높이 평가한다<br>
가장 직접적인 방식으로 기능을 구현하면 시스템의 유지보수성이 떨어질 수 있고, 그러면 코드를 이해하기 어려워지고 컴포넌트간에 보이지 않는 의존성이 생기게 된다<br>
하지만 알다시피 당면한 관심사와 장기적인 관심사간의 균형을 유지하는 일은 까다로운 문제이다</p>
<h1 id="유지-보수성을-고려한-설계"><a class="markdownIt-Anchor" href="#유지-보수성을-고려한-설계"></a> 유지 보수성을 고려한 설계</h1>
<ul>
<li>
<p>관심사의 분리</p>
<ul>
<li>관련된 변경사항이 전부 코드의 어느 한군데에 들어있다면, 뭔가 변경할 때 코드의 여러곳을 변경하지 않아도 된다
<ul>
<li>하나의 클래스가 여러 관심사를 가지고 있다면, 다른 클래스에서도 해당 관심사들을 가지고 있을 확률이 매우 높다</li>
<li>이는 각각 특정 관심사로 분리되어야 하고, 분리된 관심사들이 여러곳에서 재사용 되어야 한다</li>
<li>그러면 특정 변경사항을 적용하기 위해 코드의 여러곳을 수정하는 상황을 막을 수 있다</li>
</ul>
</li>
<li>우리는 변경사항(요구사항)을 예측할 수 없으므로, 같은 관심사들을 하나의 클래스로 모으는 연습을 계속해서 해야한다</li>
<li>e.g. 인터넷 표준 프로토콜로 전달된 메시지를 푸는 코드는 그 메시지를 해석하는 코드와 똑같은 이유로 변경되어서는 안되므로, 두 개념을 각기 다른 패키지로 나워야 한다</li>
</ul>
</li>
<li>
<p>더 높은 수준의 추상화</p>
<ul>
<li>흐름을 직접 제어하기보다는 <strong>클래스들을 조합하는 식으로 프로그램을 작성</strong>하면 더 많은 일을 해낼 수 있다</li>
<li>이는 사람들이 식당에서 음식을 주문할 때 세세한 조리법을 설명하는 것이 아니라 메뉴를 보고 음식을 주문하는 것과 같다</li>
</ul>
</li>
<li>
<p>ports &amp; adapter pattern<br>
<a href="http://getoutsidedoor.com/2018/09/03/ports-adapters-architecture/" rel="external nofollow noopener noreferrer" target="_blank">http://getoutsidedoor.com/2018/09/03/ports-adapters-architecture/</a><br>
<a href="https://dzone.com/articles/hexagonal-architecture-for-java" rel="external nofollow noopener noreferrer" target="_blank">https://dzone.com/articles/hexagonal-architecture-for-java</a><br>
기술적인 부분을 인터페이스로 분리해서 변경을 용이하게 한다 정도로만 이해했고, 실제 예제를 보지 못해서 정확히 이해하지 못하겠다</p>
</li>
</ul>
<h2 id="캡슐화와-정보은닉"><a class="markdownIt-Anchor" href="#캡슐화와-정보은닉"></a> 캡슐화와 정보은닉</h2>
<p>캡슐화와 정보은닉은 비슷해보이지만 설계의 품질을 나타낼때는 별개의 개념이다</p>
<ul>
<li>
<p>캡술화</p>
<ul>
<li><a href="https://javacan.tistory.com/entry/EncapsulationExcerprtFromJavaBook" rel="external nofollow noopener noreferrer" target="_blank">https://javacan.tistory.com/entry/EncapsulationExcerprtFromJavaBook</a></li>
<li><strong>해당 객체의 API를 통해서만</strong> 객체의 행위를 좌우할 수 있다</li>
<li>외부에서 객체의 상태를 직접 접근해 변경하거나, 무언가 행위를 하는것이 불가능하다는 의미이다</li>
<li>예상치 못한 의존성이 없음을 보장해줌으로써, 한 객체에 대한 변경이 시스템의 다른 부분에 영향을 덜 주게끔 통제할 수 있다</li>
<li>잘못 캡슐화된 코드를 활용할 경우 해당 코드를 어디서 참조하는지 찾아보고, 잠재적 영향력을 추적하는데 굉장히 많은 시간을 보내게 된다</li>
</ul>
</li>
<li>
<p>정보 은닉</p>
<ul>
<li>해당 객체의 기능을 구현하는 방법을 추상화된 API 너머로 감춘다</li>
<li>e.g. <code>정렬</code>이라는 메서드가 있으면, 내부에서 어떻게 정렬을 수행하는지 외부에서는 알 필요가 없게끔 한다</li>
</ul>
</li>
</ul>
<p>하지만 대부분의 객체지향 언어에서 제공하는 별칭(aliasing)을 통해 캡슐화를 위반할 수 있다<br>
관련이 없는 두 클래스를 묶거나, 특정 클래스를 wraping한 클래스를 만들고, 그 클래스를 통해 자식클래스에 행위들을 수행해버릴 수 있다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> B b;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doManything</span><span class="params">(B b)</span> </span>&#123; <span class="comment">// aliasing</span></span><br><span class="line">        b.doSomething(); <span class="comment">// 캡슐화 위반</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A를 통해서 B를 수정할 수 있게 되므로, 이는 캡술화를 위반한 것이다<br>
<strong>위와 같이 doManything를 호출 한 후 b의 값이 변경되어 버리는 현상이 일어나서는 안된다</strong></p>
<p>이러한 상황들을 방지하기 위해 아래와 같은 관례를 따라야 한다고 말한다</p>
<ul>
<li>변경 불가능한 값 타입을 정의하고
<ul>
<li>값 타입은 내부 값이 수정 불가능한 final이고, 값에 특정한 행위를 수행해도 새로운 객체로 반환하기 때문에 위와 같은 상황에서 안전하다</li>
</ul>
</li>
<li>전역변수와 싱글턴은 자제하며</li>
<li>컬렉션과 변경 가능한 값을 객체간에 전달할때는 그것을 복사해야한다
<ul>
<li>객체를 복사한다면 위와 같은 상황에 안전할 것이다</li>
<li>저런식으로 협력객체의 특정</li>
</ul>
</li>
</ul>
<p>이 같은 결정이 중요한 이유는 어떤 객체를 얼마나 쉽게 쓸수 있는지에 영향을 주고, 시스템 내부 품질에 기여하기 때문이다</p>
<h1 id="단일-책임-원칙"><a class="markdownIt-Anchor" href="#단일-책임-원칙"></a> 단일 책임 원칙</h1>
<ul>
<li>모든 객체는 반드시 단 한가지 명확히 규정된 책임을 지녀야 한다
<ul>
<li>그리고 그러한 객체들이 재사용되어야 한다</li>
</ul>
</li>
<li>한 객체의 역할을 설명할때는 <code>접속사</code>(와,나 등)를 사용하지 않고도 해당 객체의 역할을 설명할 수 있어야 한다
<ul>
<li>접속사로 구분되는 애들이 각각 객체로 나뉠 수 있을것이다?</li>
</ul>
</li>
</ul>
<h1 id="객체-이웃의-유형"><a class="markdownIt-Anchor" href="#객체-이웃의-유형"></a> 객체 이웃의 유형</h1>
<p>객체가 단일 책임을 지녔고, 명료한 API를 통해 이웃 객체와 통신한다면, 서로 무슨 얘끼를 할까?<br>
한 객체가 지닐 수 있는 관계는 다음과 같다</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/객체지향-스타일/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/TDD-주기의-유지/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/TDD-주기의-유지/" class="post-title-link" itemprop="url">[tdd] TDD 주기의 유지</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-24 12:29:58" itemprop="dateCreated datePublished" datetime="2019-03-24T12:29:58+00:00">2019-03-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/TDD-주기의-유지/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/TDD-주기의-유지/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>TDD 프로세스를 시작하고 나면, 그 프로세스를 매끄럽게 유지해야 한다<br>
그 상세한 방법<br>
시스템을 구축할 때 테스트를 작성하는 방법<br>
테스트를 이용해 내외적인 품질 문제에 일찍 피드백을 받는 방법<br>
테스트가 계속 변화를 뒷받침하고, 이후 개발에 걸림돌이 되지 않게 하는 방법</p>
<h1 id="각-기능을-인수-테스트로-시작하라"><a class="markdownIt-Anchor" href="#각-기능을-인수-테스트로-시작하라"></a> 각 기능을 인수 테스트로 시작하라</h1>
<p>인수 테스트는 우리가 작성하려는 기능이 아직 시스템에서 갖추지 못했다는 사실을 보여주고, 그 기능이 완성되기까지 진행 상황을 반영한다<br>
인수테스트를 작성할때는 기반 기술(데이터베이스나 웹 서버 같은)의 용어가 아닌 응용 도메인에서 나온 용어만 이용한다.</p>
<blockquote>
<p>이렇게하면 시스템에서 해야 할 일이 뭔지 이해하는데 보탬이 되고, 구현에 관한 초기 가정에 얽매이지도 않을 뿐더러 테스트가 기술적인 세부사항으로 복잡해지지도 않는다<br>
이뿐 아니라 시스템의 기술 기반 구조가 바뀌었을 때도 인수 테스트를 보호할 수 있다</p>
</blockquote>
<p>코딩을 시작하기 전에 테스트를 작성하면 달성하고자 하는 바가 명확해진다<br>
실패하는 테스트덕에 요구사항을 충족하는데 필요한만큼의 기능을 구현하는데 집중할 수 있어 기능을 완성할 확률이 높아진다<br>
테스트로 시작하게 되면 사용자 관점에서 시스템을 바라보게 되어 구현자 관점에서 기능을 짐작하지 않고 사용자가 필요로 하는 것을 이해하게 된다</p>
<p>반면 단위 테스트는 객체 집합을 격리된 상태에서 시험하므로, 그 클래스가 시스템의 나머지 부분과 조화롭게 동작할지에 대해서는 아무것도 담보하지 않는다<br>
인수테스트는 단위 테스트를 거친 객체를 대상으로 통합 테스트를 수행할 뿐 아니라, 프로젝트를 앞으로 나아가게 한다</p>
<h1 id="회귀를-포작하는-테스트와-진행상황을-측정하는-테스트를-분리하라"><a class="markdownIt-Anchor" href="#회귀를-포작하는-테스트와-진행상황을-측정하는-테스트를-분리하라"></a> 회귀를 포작하는 테스트와 진행상황을 측정하는 테스트를 분리하라</h1>
<p>새 인수 테스트는 진행중인 작업을 나타내고, 기능이 준비될 때 까지는 통과하지 않을 것이다<br>
인수 테스트를 통과하면 해당 테스트는 완료된 기능을 나타내고, 다시는 실패해서는 안된다<br>
(실패는 이전 상태로 회귀했고, 기존 코드를 망가뜨렸음을 의미한다)</p>
<p>인수 테스트를 빨간색에서 녹색으로 바꾸는 활동으로 우리는 진행상태를 측정할 수 있다<br>
정기적인 인수테스트 통과 주기는 <code>중첩된 피드백 고리를 구동하는 엔진</code>에 해당한다</p>
<p>즉 우리는 진행중인 테스트와 완료된 테스트(회귀 테스트)를 항상 분리해야 한다<br>
만약 요구사항이 바뀐다면 거기에 영향을 받은 인수테스트를 회귀 테스트 그룹에서 빼내어서 진행중인 테스트 그룹으로 옮긴 후<br>
새 요구사항을 반영토록 수정한 다음, 해당 테스트를 다시 통과하게끔 시스템을 변경해야 한다</p>
<h1 id="테스트를-가장-간단한-성공-케이스로-시작하라"><a class="markdownIt-Anchor" href="#테스트를-가장-간단한-성공-케이스로-시작하라"></a> 테스트를 가장 간단한 성공 케이스로 시작하라</h1>
<p><code>간단한</code>을 <code>지나치게 단순한</code>으로 해석해서는 안된다<br>
<code>지나치게 단순한</code> 케이스는 시스템에 가치를 별반 더하지 않으며, 더 중요한 점은 아이디어의 유효성에 관해 충분한 피드백을 전해주지 않는다는 것이다</p>
<p>그래서 가장 간단한 성공 케이스로 테스트를 시작해보는 것이 좋다<br>
해당 테스트가 동작하면 솔루션의 실제 구조에 관해 더 좋은 생각이 떠오를테고, 그 과정에서 발견한 발생 가능한 실패를 처리하는 것과 이후의 성공 케이스 사이에서 우선순위를 가늠해볼 수 있다.</p>
<blockquote>
<p>처리해야 할 실패 케이스, 리팩터링, 기타 작업들을 메모장 깉은 곳에 기록해두면 테스트 작성에 도움이 많이 된다</p>
</blockquote>
<p>기능 구현을 할 때 실패 케이스에만 집중하면 의욕을 짐작하는데 좋지않다.<br>
오류처리메나 신경쓰다 보면 아무것도 성취한 바가 없는 듯이 느껴지기 때문이다</p>
<h1 id="읽고-싶어-할-테스트를-작성하라"><a class="markdownIt-Anchor" href="#읽고-싶어-할-테스트를-작성하라"></a> 읽고 싶어 할 테스트를 작성하라</h1>
<p>각 테스트는 시스템이나 객체에서 수행할 행위로 가능한 한 명확하게 표현하는 것이 좋다</p>
<ol>
<li>테스트를 작성하는 동안에는 테스트가 실행되지 않거나 컴파일 되지 않는다는 사실을 무시하고 테스트 내용에만 집중해서 작성하는 것이 좋다</li>
<li>테스트가 잘 읽히면, 이제 컴파일이나 런타임 오류를 해결한다</li>
<li>테스트가 명확한 오류메세지를 보이면서 예상대로 실패하면, 기반이 되는 코드를 충분히 구현했음을 의미한다</li>
<li>이제 테스트가 통과되도록 만들면 된다</li>
</ol>
<h1 id="테스트가-실패하는-것을-지켜보라"><a class="markdownIt-Anchor" href="#테스트가-실패하는-것을-지켜보라"></a> 테스트가 실패하는 것을 지켜보라</h1>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/TDD-주기의-유지/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/TDD-도구들/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/TDD-도구들/" class="post-title-link" itemprop="url">[tdd] TDD 도구들</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-23 17:58:17" itemprop="dateCreated datePublished" datetime="2019-03-23T17:58:17+00:00">2019-03-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/TDD-도구들/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/TDD-도구들/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="junit"><a class="markdownIt-Anchor" href="#junit"></a> JUnit</h1>
<p>가장 많이 쓰이는 java 테스트 프레임워크이다.<br>
그 중에서도 JUnit4 버전이 가장 많이 사용된다.(현재는 JUnit5 버전까지 나와있다)</p>
<blockquote>
<p>JUnit은 기본적으로 리플렉션을 통해 클래스 구조를 파악한 후, 해당 클래스에서 테스트를 나타내는 것을 모두 실행한다.</p>
</blockquote>
<h2 id="테스트-케이스"><a class="markdownIt-Anchor" href="#테스트-케이스"></a> 테스트 케이스</h2>
<p>JUnit은 <code>@Test</code>라는 어노테이션이 지정된 메서드는 모두 테스트 케이스로 취급한다.<br>
테스트 메서드는 값을 반환하거나 매개변수를 받아서는 안 된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Some some = <span class="keyword">new</span> Some();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSomething1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSomething2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>하나 특별한점은, JUnit은 각 테스트를 실행할 때 마다 해당 테스트 클래스의 새 인스턴스를 생성하여 호출한다는 점이다.</p>
<blockquote>
<p>위의 테스트들을 전부 실행하면 2개의 <code>SomeTest</code> 인스턴스가 생성되고, 각자 <code>@Test</code> 메서드들을 실행하게 된다.</p>
</blockquote>
<p>이런식으로 매번 새 인스턴스를 생성하면 각 테스트간의 격리성을 확보할 수 있다. 테스트 객체의 필드가 각 테스트에 앞서 대체되기 때문이다.<br>
이는 테스트에서 테스트 객체 필드의 내용을 맘껏 바꿀 수 있다는 의미이다.</p>
<blockquote>
<p><code>testSomething1</code>에서 <code>some</code>의 값을 변경해도 <code>testSomething2</code>에는 영향을 주지 않는다</p>
</blockquote>
<h2 id="assertion"><a class="markdownIt-Anchor" href="#assertion"></a> assertion</h2>
<p>기본적으로 테스트들은, 각 테스트를 수행하고 그 결과를 assertion(단정)하는 식으로 작성된다.<br>
여기서 JUnit에서 제공하는 assertion 메서드들을 사용할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StoreTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Store store = <span class="keyword">new</span> Store();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> 결제수단을<span class="title">_</span>체크한다() </span>&#123;</span><br><span class="line">        assertTrue(store.canPay(PaymentMethod.Money));</span><br><span class="line">        assertFalse(store.canPay(PaymeneMethod.CreditCard));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> 특정<span class="title">_</span>상품을<span class="title">_</span>찾는다() </span>&#123;</span><br><span class="line">        assertNotNull(store.find(<span class="string">"치킨"</span>));</span><br><span class="line">        assertNull(store.find(<span class="string">"가죽자켓"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>보다시피 canPay의 결과가 true/false가 나올것이다 라고 단정(assertion) 했고,<br>
find의 결과가 null이 아니라고 단정(assertion) 했다.</p>
<h2 id="예외-예상하기"><a class="markdownIt-Anchor" href="#예외-예상하기"></a> 예외 예상하기</h2>
<p><code>@Test</code> 어노테이션은 선택적 매개변수로 <code>expected</code> 라는 것을 지원한다.<br>
이 매개변수는 테스트 케이스에서 던져질 예외를 선언한다. 선언한 예외가 발생하면 테스트가 성공한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IllegalArgumentException.class)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> 검색어를_입력하지_않는다() &#123;</span><br><span class="line">    store.find(<span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>find 메서드는 검색어로 null을 받으면 IllegalArgument 예외를 리턴하게 작성되어 있다.<br>
그러므로 위의 메서드는 성공하게 된다.</p>
<h2 id="테스트-픽스쳐"><a class="markdownIt-Anchor" href="#테스트-픽스쳐"></a> 테스트 픽스쳐</h2>
<p>테스트가 시작할 때 <code>존재하는 고정된 상태</code>를 의미한다.<br>
테스트를 수행하기 전에 필요한 특정 상태들을 의미한다. 특정 협력객체나, 특정 데이터들이 있을 수 있다.</p>
<p>JUnit은 각 테스트마다 인트턴스를 새로 생성하므로<br>
간단히 인스턴스 변수 선언과 동시에 초기화하거나 생성자 같은것을 써서 픽스쳐를 초기화하면 되긴하지만,<br>
JUnit에서 제공하는 특정 어노테이션들을 사용하면 좀 더 명시적으로 픽스쳐 초기화가 가능하다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Store store = <span class="keyword">new</span> Store();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    store.addProduct(<span class="string">"chicken"</span>);</span><br><span class="line">    store.addProduct(<span class="string">"pizza"</span>);</span><br><span class="line">    store.addProduct(<span class="string">"beer"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@After</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 별로 할게 없음..</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Before</code> 메서드가 모든 테스트 실행전에 실행되므로, 모든 테스트는 3가지 상품이 들어간 상태에서(동일한 상태에서) 테스트를 수행할 수 있게 된다.<br>
이런식으로 모든 테스트 메서드에서 필요한 상태를 초기화하는데 사용하면 유용하다.<br>
<code>@After</code> 메서드는 테스트 메서드가 끝난 후 수행되는데, 사실상 여기서 수행할 작업이 많지는 않다.<br>
생성된 픽스쳐를 정리하는 작업 같은것도 전부 JVM 가비지 컬렉터에서 잘 수행해주기 때문이다.</p>
<h2 id="테스트-러너"><a class="markdownIt-Anchor" href="#테스트-러너"></a> 테스트 러너</h2>
<p>JUnit이 클래스를 대상으로 리플렉션을 수행해 테스트를 찾아 해당 테스트를 실행하는 방식은 <code>테스트 러너(test runner)</code> 에서 제어한다.<br>
테스트 클래스에서 사용하는 러너는 <code>@RunWith</code> 어노테이션으로 설정할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>JUnit4의 현재 default runner는 <code>BlockJUnit4ClassRunner</code> 라고 한다.</p>
</blockquote>
<h1 id="햄크레스트-매처와-assertthat"><a class="markdownIt-Anchor" href="#햄크레스트-매처와-assertthat"></a> 햄크레스트 매처와 assertThat</h1>
<p>햄크레스트는 매칭 조건을 선언적으로 작성하는 프레임워크이다.<br>
<code>matches</code>라는 boolean을 반환하는 메서드를 가진 <code>Matcher</code> 인터페이스를 구현하는 많은 클래스들을 제공한다.<br>
이 클래스들을 사용하면 기존의 단순한 assertion 구문들을 좀 더 다양하게 사용 가능하다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Matcher&lt;String&gt; containsBananas = <span class="keyword">new</span> StringContains(<span class="string">"bananas"</span>);</span><br><span class="line"></span><br><span class="line">assertTrue(containsBananas.matches(str));</span><br></pre></td></tr></table></figure>
<p>햄크레스트는 코드의 가독성을 높이고자 Matcher를 생성하는 부분을 static factory 메서드로 제공한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.CoreMatchers.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">banana_match</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    assertTrue(containsString(<span class="string">"bananas"</span>).matches(str));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>하지만 실제로는 위와 같은 방법보단, self-describing 특성을 가진 <code>assertThat</code>을 주로 사용한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assertThat(str, containsString(<span class="string">"bananas"</span>));</span><br><span class="line">assertThat(str, not(containsString(<span class="string">"bananas"</span>)));</span><br></pre></td></tr></table></figure>
<p><code>assertThat</code>은 Matcher를 직접 인자로 받을 수 있다.<br>
보다시피 <code>str은 &quot;bananas&quot; 문자열을 포함하고 있다</code> 의 형태로 작성됨으로써 테스트 코드가 더 잘 읽힌다.<br>
(참고로 햄크레스트는 위에서 사용된 <code>not</code> Matcher 처럼 다른 매처를 조합할 수 있는 유용한 기능을 제공한다)</p>
<p>이러한 Matcher는 몇가지 조건만 만족하면 사용자가 쉽게 직접 정의해서 사용할 수 있다.</p>
<h1 id="assertj"><a class="markdownIt-Anchor" href="#assertj"></a> AssertJ</h1>
<p>assertThat과 햄크레스트를 적절히 조합하여 테스트를 작성하는 것만해도 충분하지만, 좀 더 풍부한 구문을 제공하는 <code>AssertJ</code> 라는 라이브러리도 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> 오브젝트() &#123;</span><br><span class="line">    assertThat(object).isNotNull();</span><br><span class="line"></span><br><span class="line">    assertThat(object).isSameAs(otherObject);</span><br><span class="line">    assertThat(object).isEqualTo(otherObject);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> 컬렉션() &#123;</span><br><span class="line">    assertThat(list).isSorted();</span><br><span class="line">    assertThat(list).hasSize(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>보다시피 좀 더 직관적이고, 풍부한 메서드들을 제공한다.<br>
게다가 assertion과 햄크레스트를 직접 static import 하지 않아도 되는 편리함도 있으니, 사용해보는 것도 나쁘지 않다.</p>
<h1 id="jmock2"><a class="markdownIt-Anchor" href="#jmock2"></a> JMock2</h1>
<p>JMock을 사용하면 mock 객체를 JUnit 같은 테스트 프레임워크에 붙여서 사용할 수 있도록 해준다.<br>
JMock의 핵심 개념은 모조 객체와 목 객체, 예상 구문이다.<br>
아래는 JMock을 이용한 행위 검증의 예제이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(JMock.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuctionMessageTranslatorTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Mockery context = <span class="keyword">new</span> JUnit4Mockery(); <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AuctionEventListener listener = context.mock(AuctionEventListener.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AuctionMessageTranslator translator = <span class="keyword">new</span> AuctionMessageTranslator(listener);</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifiesAuctionCloseWhenCloseMessageReceived</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        message.setBody(<span class="string">"SOLVersion : 1.1; Event: Close;"</span>);</span><br><span class="line">        </span><br><span class="line">        context.checking(<span class="keyword">new</span> Expectations() &#123;&#123;</span><br><span class="line">            oneOf(listener).auctionClosed();</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">        </span><br><span class="line">        translator.processMessage(UNUSED_CHAT, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>여기서 <code>모조 객체</code>라는 개념이 나오는데, 현재 이해하기로는 <code>목 객체들을 담는 그릇</code> 정도로 이해된다… JMock runner가 읽는 대상들?</p>
<ol>
<li>JUnit이 JMock 테스트 러너를 사용하게 된다. 이 러너는 테스트가 끝나는 시점에 모든 모조 객체를 자동으로 호출해 모든 목 객체가 예상대로 호출되었는지 검사한다.</li>
<li>모조 객체를 생성한다. JMock 러너가 검사할 목 객체들이 담긴다.</li>
<li>AuctionEventListener의 mock 객체를 생성한다. 자동으로 context에 담긴다.</li>
<li>SUT에 mock 객체를 주입한다. SUT는 그 사실을 모르고, 알 필요도 없다.</li>
<li>모조객체에서 검사할 내용(행위 검증)을 작성한다. listener 목객체가 auctionClosed 메서드를 정확히 1번 호출할 것을 예상하고 있다.</li>
<li>SUT가 행위를 수행한다.</li>
<li>테스트가 끝나면 JMock runner는 모조객체(현재는 context)에 명시된 행위들을 검증한다</li>
</ol>
<p>개인적 느낌인데, 작성하기가 조금 어려운 부분이 있는 것 같다.</p>
<h1 id="mockito"><a class="markdownIt-Anchor" href="#mockito"></a> mockito</h1>
<p>JMock보다 좀 더 강력한 기능을 제공하는 mockito 라는 라이브러리가 있다.<br>
아래는 사용법에 대해 작성된 글이다.</p>
<p><a href="https://github.com/mockito/mockito/wiki/Mockito-features-in-Korean" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/mockito/mockito/wiki/Mockito-features-in-Korean</a></p>
<p>간단히 내가 느끼는 mockito의 장점은 아래 정도이다.</p>
<ul>
<li>mockito는 JMock 처럼 모조객체, 목 객체에 대한 구분이 없다.</li>
<li>JMock에도 있는지 모르겠으나(당연히 있곘지…) stub을 매우 간단하게 지원한다.</li>
<li>행위 검증도 매우 간단하게 지원한다.</li>
</ul>
<p>나는 개인적으로 이 라이브러리가 좀 더 작성하기 편리하고, 명시적인 것 같다.</p>
<p>참고로 mockito 보다 더 강력한 기능을 제공하는 PowerMock 이라는 애도 있다.(private 메서드 테스트, static 메서드 주입 등 까지 제공한다)</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/TDD-도구들/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/TDD-주기의-시작/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/TDD-주기의-시작/" class="post-title-link" itemprop="url">[tdd] TDD 주기의 시작</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-22 00:26:34" itemprop="dateCreated datePublished" datetime="2019-03-22T00:26:34+00:00">2019-03-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/TDD-주기의-시작/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/TDD-주기의-시작/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>되돌아보면 우리는… 개발을 다 진행해놓고 마지막에 통합하면서 피드백을 받았던 것 같다.<br>
이 마지막 순간에 변경되는 부분도 굉장히 많고, 서로가 잘못 이해한 부분도 많이 발생한다.<br>
최악의 경우는 작업을 뒤집거나, 누군가가 포기하고 가야하는 상황도 발생한다.</p>
<p>그러므로 앞서 얘기했듯이, <strong>빠른 피드백을 받을 수 있게끔 시스템을 구성하는 작업(중첩된 피드백 고리)은 매우 중요</strong>하다.</p>
<ul>
<li>위에서도 언급했듯이, 이런 시스템의 구성을 나중으로 미루는 것은 매우 위험하다</li>
<li>저 정도 예시면 양반이지, 배포할 수 없어서 프로젝트가 취소되거나 마지막에 테스트를 추가했는데도 불구하고 오류율이 너무 높아 시스템이 폐기되기도 한다(저자의 경험)</li>
<li><strong>피드백은 아주 근본적인 도구이며, 올바른 방향으로 나아가고 있는지 최대한 미리 파악하고자 한다</strong></li>
</ul>
<p>그 중에서도 외부와의 피드백 고리를 형성하는 것은 중첩된 피드백 고리를 구성하는 첫번쨰 단추이고, 가장 중요하다.<br>
이 말인 즉 <code>자동화된 빌드・배포・테스트 주기 전체</code>를 가장 처음부터 구현해야 함을 의미한다.<br>
근데 사실 말이 쉽지, 이렇게 구성하기에는 할일도 매우 많고, 어렵다.<br>
그러면 우리는 무엇부터 시작해야 할까?</p>
<h1 id="우선-동작하는-골격을-대상으로-테스트하라"><a class="markdownIt-Anchor" href="#우선-동작하는-골격을-대상으로-테스트하라"></a> 우선 동작하는 골격을 대상으로 테스트하라</h1>
<ul>
<li>먼저 <code>동작하는 골격</code>을 만들어야 한다
<ul>
<li>전 구간을 대상으로 자동 빌드・배포・테스트를 할 수 있는 실제 기능을 가장 얇게 구현한 조각을 말한다</li>
<li>첫 기능을 구현할 수 있을 정도의 자동화, 주요 컴포넌트, 통신 메커니즘이 포함될 것이다</li>
</ul>
</li>
<li>이 구조를 이용해 <code>유의미한 첫 기능에 대한 인수 테스트</code>를 작성한다
<ul>
<li>이후로는 시스템의 나머지 부분을 대상으로 테스트 주도 개발을 진행할 수 있게 모든 것이 제자리에 놓일 것이다</li>
</ul>
</li>
</ul>
<blockquote>
<p>동작하는 골격을 만드는 과정에 배포 단계를 포함한 이유는 아래와 같다</p>
<ul>
<li>배포 단계는 오류가 발생하기 쉬운 활동이므로 실제 환경에 배포해야 할 때 까지 스크립트를 철저히 검증해야 하기 때문이다</li>
<li>배포 과정을 자동화 하는 것 만큼 프로세스를 이해하는데 도움이 되는 것은 없다</li>
<li>배포 단계에서 개발팀이 조직의 다른 부문과 접촉하기도 하며, 실제로 어떻게 운영되는지도 배워야하기 때문이다</li>
</ul>
</blockquote>
<p>참고로 동작하는 골격을 만들때는 골격의 구조에만 집중하고, 테스트가 최대한 표현력을 갖추게끔 테스트를 정리하는 일에 대해서는 크게 신경쓰지 않는다<br>
동작하는 골격과 그것을 보조하는 기반 구조는 테스트 주도 개발을 시작하는 방법을 도와주기 위해 존재하는 것이기 때문이다</p>
<h1 id="동작하는-골격의-외형-결정"><a class="markdownIt-Anchor" href="#동작하는-골격의-외형-결정"></a> 동작하는 골격의 외형 결정</h1>
<p>어떤 전체 구조에 관한 구상 없이는 빌드・배포・테스트 주기를 자동화 할 수 없으므로,<br>
계획한 첫 출시를 달성하는데 필요할 주요 시스템 컴포넌트와 그러한 컴포넌트의 상호 작용 방식에 대한 대략적인 그림은 필요하다.</p>
<blockquote>
<p>이는 화이트보드에 몇분만에 그릴 수 있다<br>
공개된 장소에 이런 구조를 그려놓으면 코드 작성 시 팀이 업무 방향을 참고하는데 도움이 된다(마파 문디)</p>
</blockquote>
<p>당연하지만, 이 같은 초기 구조를 설계하려면 시스템의 목적을 어느 정도 이해해야 한다<br>
<strong>클라이언트의 요구사항(기능적 요구사항, 비기능적 요구사항)을 고수준 관점에서 바라보고 의사결정에 참고해야 한다</strong><br>
그렇지 않으면 위험을 무릅쓰고 하는 일들이 죄다 의미가 없어진다</p>
<p><img src="https://lh3.googleusercontent.com/Sclm2o15GcyE3_jdothc4VLXpeBP_ewwY96loaiD8h9xd3QaDf9DaRP-tHaahWKKGALMbm1V6suovTMgh1QJSR5uFh13mAmt9MMDHis_U8uaWoKj_krT4GtoHoEkPMeIKk5KGbSzOpbso31HabNC92LGtKRabQmHVTmkBwsg6iedYZDOEGeOA_MHvuH9K3qQGnUv12qE6XXlWrkRv3BmPnZTD52jbAtpDyIXDcqOlQ7Y4XXHzgzb8IvRRPTr4OSIB1xczYJ3-MU8Cq3Sd6byjjl0pYz_XlTsgKySHNtfA4RLkCZ-sKBx66sgXwUkqcnYE__bZpjlfg6onHnXirq-TzJOamVOxMxjgZzFIeHHaamQYP2Bn4_4rivwGis_sRGoCyhXbm0bXUFJxddbL_z7VLtxtD8DFPjljZXVdeo7k64Qc7JFo2CDSmjSapAyZ9VhzVLyIVq0t3JX0tgSf6kFY4IXRew9eHaooRywVVeYlo2-NbNzAOsOJOw_BBQMxSnLD-JuY1rsfQNHvJfDp-hiLbKK4x-WA1x9m-uaLkGDu5y8_EgJICKhDMTACTohQVKJkp65i62ggMbqGC-YPRcr9pKmSZqECI_9oHTclcs_SZW9xjVIAbCMlPOe04iPHxAdR-HY6fsoLMVGflZY16nPyHfV28e1BNM=w882-h229-no" alt="테스트 주도 주기"></p>
<p>참고로 이를 <code>과도한 사전 설계</code>와 혼동하지 않아야 한다<br>
실제 피드백을 토대로 배우고 개선해나가는 과정을 시작할 수 있게(+TDD 주기를 시작할 수 있게)하는데 필요한 최소한의 의사결정만을 내리는 것이 좋다<br>
(현재 생각하고 있는 바가 틀릴 가능성이 있으므로, 시스템이 성장해가면서 세부 사항을 파악해나간다)</p>
<h1 id="피드백-소스-구축"><a class="markdownIt-Anchor" href="#피드백-소스-구축"></a> 피드백 소스 구축</h1>
<p>아래의 글로 <code>피드백의 중요성</code>을 재고하고 있다</p>
<blockquote>
<p><strong>어플리케이션 설계에 대해 내린 의사결정이나, 어플리케이션 설계가 근거하는 가정의 옳고 그름에 대해서는 아무것도 보장할 수 없다</strong><br>
그저 최선을 다할 뿐이며 현재 밟고 있는 절차에 피드백을 적용해 최대한 빨리 의사결정이나 가정을 검증하는데 의지할 뿐이다</p>
</blockquote>
<p>아래는 위의 <code>테스트 주도 주기</code>가 주는 피드백에 대해 그려놓은 그림이다</p>
<p><img src="https://lh3.googleusercontent.com/GEOVJp8MMcArH1mGIoFPjC8uLNKczgp_SrDmxR4NnecXuHRDYgmbtJannmt58E4tuF3A0zo71_TKsIr3AqQwov7Iy_rB0Un00m_ZCiSiQ4uA0ogb77eIoMxfh4iow95OTCFfe5P5RQLXqs8Lt5eaNM0jsS9_U9nYP43DK019lzYn2RGavF1OseqqoxRYQ9kge5czEX7M7NH_XXdOj2QAXcx_Dot70025msdldoyWHjRDFjItSJFP_evjWZcpc95dqxqbM0cWXBYG0Ifyvy_TwZTIQfV1dsveRhSfNWfhcP2Tj6yMWrmUSz2HZjGZzlQoxP6W-DV-bPFeK2C7hgbVe5qMf37g-_4RGtt-RZIEcmSWXqbT9Bgm1TT0YULSzkxlx3lLTtcZ-SdeEW6K02LlIGb7cikJkfD4y5WdGDzB_AfdryWeW1ntA0jttjOe6lY4RmT2ZNbw292FQ01SfcDegLZ7kRn4F3bON7Jv99f8o34WGJAsaWcEd9VT73ur7lau-4NUVYriJNyCmBvMiLByJt1uv5GYdUKdQ4kl_LHIHp6motBXN8lWDCphg5IVVvf48NtPo6iUBryRtWEiTKj67PU5wLOVSvNY2Q8RTRcJFkSnFXXmJkWDWvtNeiLWYV04bTVe_8WFCJ2EK7DnvE9Vs4FOZ92Z5bA=w872-h351-no" alt="요구사항 피드백"></p>
<p>보다시피 각 과정은 서로에게 피드백이 된다<br>
이러한 시스템을 구축함으로써 우리의 기능이 요구사항에 얼마나 부합하는지, 우리 시스템 구현은 어떤지 빠르게 평가할 수 있고, 빠르게 반영할 수 있다.<br>
<code>최종적으로 우리는 안전해지고, 완전한 소프트웨어를 얻게 될 것이다!!!</code></p>
<blockquote>
<p>또 하나의 가장 큰 헤택은 <code>뭘 배우늗 거기에 맞춰 시스템을 변경할 수 있으리라</code>는 점이다<br>
뭐든 테스트를 먼저 작성한다는 것은 <code>철저한 회귀 테스트 모음을 갖게 된다</code>는 것을 의미하기 때문이다<br>
물론 어떤 테스트도 완벽하지 않지만, 견고한 테스트 모음이 있으면 중대한 변경을 안전하게 할 수 있다는 사실은 확실하다</p>
</blockquote>
<hr>
<p>처음에는 이러한 순서대로 점진적인 개발을 하는 과정이 불안정하고, 활동량도 굉장히 많을 것이지만 자동화가 구축되고 나면 반복적인 과정으로 안정화된다</p>
<blockquote>
<p>나중에 통합 절차를 수행하는 프로젝트는 침착한 분위기에서 시작하지만, 처음으로 시스템 통합을 시도하게 되는 후반부에 힘들어지곤 한다<br>
통합을 나중에 하는 방식의 경우 어떤 일이 일어날지 예측하기 불가능한데, <strong>팀에서 엄청나게 많은 각 부분을 제한된 시간에 짜맞춰야 하고 실패한 부분을 고치는 일도 감안해야 하기 때문이다</strong><br>
그래서 경험이 풍부한 이해관계자는 프로젝트 초반부에 생기는 불안정성에 고약하게 반응한다<br>
후반후에 들어가면 상황이 더 악화되리라 예상하기 때문이다<br>
<strong>비단 통합 뿐만이 아니다. 우리는 각종 테스트들을 먼저 작성함으로써 혼란을 미리 잡고가게 되는 효과를 가지게 된다.</strong></p>
</blockquote>
<p><img src="https://lh3.googleusercontent.com/WZOowcX2_1KjkKHzNQhCF-x0SiMlIFZjuAT1oTsZSwYee0zBcPrvggU64AN952M86987WyWhq1InTB8_z3bOo8VZ04NOP4dPOV5F2b4r-lcmrDqEbLQ6KESACL19EWfShx9DQAFRsKkBfXH363hIKphswwLpJo-u_AEWFZEOTwfD7Di9YaO33Z-Mo80GJhJddpK323W_VrSqvZq7TzAcQuGLsyxdd-OCkh1tA5ZsKmyWqYlgY0s_yBwZUBNPqwli5X4um6O200d-FtifNT4P5Xsh0r02jWW6RWuumJToqbweuOzDa8fN7UQzFViY3DF1Cl9ZdXLFp-HdtgubP74pTGoYGm7rU8ZIdqKt_xkDNdkbGjI8Cf0xiVtWAco1XeSagWDwjvB0O3lAm_cGBXBp-tl22qFlpfMwy8PF1UsvnnNLZ7NBNCrTxOO4gsen0loemkBHmZn3I5k4wMK2fgxNuAlTK-ninGRa8gHK5sXVjK-YOYHZIrU0Di6BPvBRFUKDmxu62ZbSR9G0Dld4sPD8DlihlZNtCiRnA1Z_7XX7B0mX1gVTk9xw34cptI8XTaRBFT5MQKZfymrnf8TKzAHFP0HZm5nb19hG0E5UOvx0CqBriHuPgulR4E0shj66nB8AqM59zlFQnpZt5eXVzniSMq7S0UO4N7Y=w960-h720-no" alt="테스트 먼저 vs 테스트 나중에"></p>
<p>가장 중요한 것은 방향 감각을 확보하는 것과 가정을 테스트할 구체적인 구현을 갖춰야 한다는 것이다<br>
<code>동작하는 골격</code>은 프로젝트 초기에 각종 쟁점을 드러내지만, 프로젝트 초기라면 아직까지 그러한 쟁점을 해결할 시간과 예산, 의지가 있을 때이다</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/TDD-주기의-시작/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/git/commit-message-convention/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/git/commit-message-convention/" class="post-title-link" itemprop="url">[git] commit message convention</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-19 02:40:05" itemprop="dateCreated datePublished" datetime="2019-03-19T02:40:05+00:00">2019-03-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/git/commit-message-convention/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="git/commit-message-convention/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>커밋 메세지 컨벤션<br>
<a href="https://meetup.toast.com/posts/106" rel="external nofollow noopener noreferrer" target="_blank">https://meetup.toast.com/posts/106</a><br>
<a href="https://doublesprogramming.tistory.com/256" rel="external nofollow noopener noreferrer" target="_blank">https://doublesprogramming.tistory.com/256</a></p>
<ul>
<li>feat : 새로운 기능 추가</li>
<li>fix : 버그 수정</li>
<li>docs : 문서 수정</li>
<li>style : 코드 포맷팅, 세미콜론 누락, 코드 변경이 없는 경우</li>
<li>refactor : 코드 리펙토링</li>
<li>test : 테스트 코드, 리펙토링 테스트 코드 추가</li>
<li>chore : 빌드 업무 수정, 패키지 매니저 수정</li>
</ul>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/git/commit-message-convention/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/객체를-활용한-테스트-주도-개발/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/객체를-활용한-테스트-주도-개발/" class="post-title-link" itemprop="url">[tdd] 객체를 활용한 테스트 주도 개발</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-17 12:46:05" itemprop="dateCreated datePublished" datetime="2019-03-17T12:46:05+00:00">2019-03-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/객체를-활용한-테스트-주도-개발/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/객체를-활용한-테스트-주도-개발/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>객체의 설계에 대해 설명하고 있다</p>
<h1 id="객체망"><a class="markdownIt-Anchor" href="#객체망"></a> 객체망</h1>
<p>객체 지향 설계는 객체 자체보다 객체간의 의사소통에 더 집중한다</p>
<blockquote>
<p>중요한 것은 <code>메시지 전달</code>이며, 위대하고 성장 가능한 시스템을 만들때의 핵심은 모듈간의 의사소통에 있지, 모듈의 내부 특성이나 작동 방식에 있지 않다</p>
</blockquote>
<p>시스템은 객체를 생성해 서로 메시지를 주고받을 수 있게 조립하는 과정을 거쳐 만들어진다.<br>
시스템의 행위는 객체의 조합(객체의 선택과 연결 방식)을 통해 나타나는 특성이다.</p>
<p><img src="https://lh3.googleusercontent.com/erbdSEbjM_B5uzzhvwh5x2i_vSzS_ueVCdocpWMKH2mcBrNHhJZl7sS6R9KAtqjXfrko9PcKdTmDy5g5H8ri-cvvfbsscY8qV_Qq0dDcXGg2vEyCyf52gy62mGJ7PWSLg8KF7U-WAay759fcioDAbY-le_Ki1lsCv5aToTPuRRpF-I1Nsf6Z6PeFanlELgn5MQgi-Jg0PFIAKKryiv7B-LhL-Yd2IYNhVIHYuvhvxTqg15Zk3bl6r7xihPV0qyxNmvOcDUJFCD2iwIzUt9tCUV4mXhd-eTHt-tIk2OjBVj_DwYuRMACqMLUD1WbpyFwLD6AhbDY6AwHjE34eQU8iersoHDWYgh1kwVvT4v_Ym6VI1FoGwqj-OPtd06pMaY8HU7kOYMXbQk0LH3Lv7RkKv5uupib5-7L3cYsSac7lm-8se6ZY4_xY6fpDX9s8UA8BwVu0cz4nQcNmTO6ZXsnnp5KZoNXYq5zrwow8X1jRZ-Kjupui0Eu4gQ5HUu09l4-7chCmqa6H4uOJI9zC0hThnuKirb_CIb0Hdk0w_9p0H-Wmb97fh4PI_aig-5jP0xA1d7w34X6eVzskXoUaOgevqEQ1-kWyrrDw3lz_tgpEGfeDM7WJHZ_wX6ABGungb3Z4TqJ8dvpUNJ4qiYdqs3d1qBlHGYnsDuo=w960-h720-no" alt="객체망"></p>
<p>이런식으로 시스템을 구축하면 방법(how)이 아니라 목적(what)에 집중할 수 있어서, 시스템에 포함된 객체의 구성을 변경해 시스템 작동 방식을 쉽게 바꿀 수 있다.</p>
<h1 id="값과-객체"><a class="markdownIt-Anchor" href="#값과-객체"></a> 값과 객체</h1>
<p>시스템을 설계할 때는 값(value)과 객체(object)를 구분하는 것이 중요하다.<br>
값은 변하지 않는 양이나 크기를 나타내며, 객체는 식별자를 가지고 시간이 지남에 따라 상태가 변할수도 있는 애들을 가리킨다.<br>
(DDD의 Value Object와 Reference Object)<br>
<strong>대부분의 객체지향 언어에서는 이 두 개념을 모두 클래스라는 동일한 언어 구성물로 구현한다는 점에서 혼동의 여지가 있다</strong></p>
<ul>
<li><strong>값(value)</strong>
<ul>
<li>양이 고정된 불변 인스턴스</li>
<li>개인 식별자가 없으므로 두 값 인스턴스의 상태가 같다면 사실상 동일한 셈이다
<ul>
<li>그러므로 두 값의 식별자를 비교하는 것은 적절하지 않다</li>
<li><code>string1 == string2</code> 보단 <code>string1.equals(string2)</code> 를 쓰라고 하는 이유이다</li>
</ul>
</li>
</ul>
</li>
<li><strong>객체(object)</strong>
<ul>
<li>변경 가능한 상태를 이용해 시간의 추이에 따른 객체의 행위를 나타낸다</li>
<li>두 객체 인스턴스의 상태가 정확히 동일하더라도 별개의 식별자를 가진다
<ul>
<li>즉, 식별자로 비교해야 한다</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="메시지를-따르라"><a class="markdownIt-Anchor" href="#메시지를-따르라"></a> 메시지를 따르라</h1>
<ul>
<li>객체를 설계할 때 <code>다른 객체와 쉽게 관계를 맺을 수 있게 객체를 설계</code>해야 한다</li>
<li>객체가 <code>의사소통 패턴</code>을 따르고, 객체간의 의존성이 명시적이어야 한다
<ul>
<li>의사소통 패턴은 다른 객체와 상호 작용하는 방법을 관장하는 각종 규칙으로 구성되어 있다</li>
<li>객체의 역할, 객체에서 전달 가능한 메세지, 전달 가능한 시점 등</li>
</ul>
</li>
<li>의사소통 구조는 처음 객체를 배울때 느끼는 정적인 분류에서 개념적으로 굉장히 발전한 단계에 해당한다
<ul>
<li>객체간 메시지 주고받는 것에 더 집중한 방식이라고 생각된다</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>역할, 책임, 협력자</strong><br>
객체는 역할을 하나 이상 구현한 것이며, 책임은 어떤 과업을 수행하거나 정보를 알아야 할 의무를 말한다<br>
협력은 객체나 역할(또는 둘 다)의 상호 작용에 해당한다</p>
<blockquote>
<p>CRC 카드(또는 UML)를 이용해가며 객체를 모델링 해보는 것도 좋은 방법이다</p>
</blockquote>
</blockquote>
<h2 id="묻지-말고-말하라"><a class="markdownIt-Anchor" href="#묻지-말고-말하라"></a> 묻지 말고 말하라(★)</h2>
<p>서로간에 메시지를 전달하는 객체가 있다면, 서로 무슨 이야기를 할까?</p>
<blockquote>
<p><code>객체를 호출할 땐</code> 이웃 객체가 하는 역할 측면에서 해당 객체가 무엇을 원하는지 기술하고,<br>
<code>호출된 객체</code>가 전달받은 바를 어떻게 실현할 지 결정한다</p>
</blockquote>
<ul>
<li><strong>디미터의 법칙(Law of Demeter), 묻지 말고 말하라(Tell, Don’t Ask)</strong>
<ul>
<li>객체는 그것이 내부적으로 보유하고 있거나 메시지를 통해 확보한 정보만 가지고 의사결정을 내려야한다</li>
<li>객체가 다른 객체를 탐색해 뭔가를 일어나게 하면 안된다</li>
<li>호출자는 해당 객체의 내부 구조나 또는 그 너머에 존재하는 시스템의 구조에 대해 알 필요가 없다(알아서도 안된다)</li>
<li>이 스타일을 일관되게 따른다면 코드가 좀 더 유연해진다
<ul>
<li>같은 역할을 수행하는 객체를 손쉽게 교체할 수 있기 때문이다</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 외부에서 물어서 직접 판단하지 말고</span></span><br><span class="line">master.getModelisable()</span><br><span class="line">    .getDockablePanel() <span class="comment">// 이러한 것을</span></span><br><span class="line">    .getCustomizer() <span class="comment">// '열차 전복'이라고 한다  </span></span><br><span class="line">    .getSavetem().setEnabled(Boolean.FALSE.booleanValue());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 해당 객체가 판단하게끔 하라  </span></span><br><span class="line">master.allowSavingOfCustomisations();</span><br></pre></td></tr></table></figure>
<p>이렇게 작성함으로써 추가적으로 얻는 이점은 아래와 같다</p>
<ul>
<li>master를 이용하는 쪽에서 메서드를 해당 객체의 내부 구조까지 몰라도 된다
<ul>
<li>기존에는 연이어 호출하는 모든 객체의 타입까지 알고 있었다</li>
</ul>
</li>
<li>만약 설계가 변경되어도, 이 코드에 미치는 영향이 작다
<ul>
<li>기존처럼 사용되는 곳이 많았다고 하면, 설계 변경이 미치는 영향이 매우 컸을것이다</li>
</ul>
</li>
<li>명시적인 이름을 부여하였기 때문에 코드를 이해하기가 더 쉬워진다</li>
</ul>
<h2 id="그래도-가끔은-물어라"><a class="markdownIt-Anchor" href="#그래도-가끔은-물어라"></a> 그래도 가끔은 물어라</h2>
<p>물론 모든 것만을 <code>말하지</code>만은 않는다<br>
값과 컬렉션으로부터 정보를 가져오거나 팩토리를 이용해 새 객체를 생성할때(?)는 <code>묻는다</code></p>
<blockquote>
<p>검색이나 필터링을 할 때를 생각해보면 된다</p>
</blockquote>
<p>그러나 이렇게 묻는 과정에서도 열차 전복은 피하게끔 작성해야 한다</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 이렇게 내부 구조를 노출해서는 안된다  </span></span><br><span class="line"><span class="keyword">if</span>(carriage.getSeats().getPercentReserved() &lt; persentReservedBarrier)&#123;</span><br><span class="line">    request.reserveSeatsIn(carriage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 정말로 내가 원하는 답을 주게끔 질문을 해야한다  </span></span><br><span class="line"><span class="keyword">if</span>(carriage.hasSeatsAvailableWithin(persentReservedBarrier))&#123;</span><br><span class="line">    request.reserveSeatsIn(carriage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이렇게 작성하면 추가적으로, 이해하기 쉽고 테스트하기 쉬워진다는 장점을 얻을 수 있다</p>
<p>참고로 이런식의 질의(getter 포함) 메서드는 되도록 적게 쓰려고 하는 것이 좋다</p>
<ul>
<li>질의가 객체 바깥으로 <code>새어 나가서</code> 시스템이 더 경직될 수 있기 때문이다</li>
<li>호출하는 객체의 의도를 서술하는 질의를 작성하려고 애써야한다</li>
</ul>
<h1 id="협력-객체의-단위-테스트"><a class="markdownIt-Anchor" href="#협력-객체의-단위-테스트"></a> 협력 객체의 단위 테스트</h1>
<p>위의 디미터의 법칙을 지키다보면, assertion을 하나도 쓸 곳이 없어지는 것 같은 현상을 맞이하게 된다<br>
(각 객체가 서로 명령을 전달하고, 상태를 질의하는 수단을 노출하지 않기 때문에)</p>
<p>호출되었을때 주위에 하나 또는 그 이상의 이웃객체에 메시지를 보내는 객체의 메서드가 있다고 한다면,<br>
해당 메서드가 올바르게 수행되었는지 어떻게 테스트 할 수 있을까(내부 상태를 드러내지 않고)?</p>
<p>협력자가 잘 호출되었는지 mock으로 검증하라?</p>
<p>SUT의 이웃(협력자)를 stub으로 대체하면 된다<br>
실제로 SUT를 테스트할때는 협력자까지 같이 테스트 할 필요는 없기 때문이다.<br>
협력자에 대한 테스트들은 협력자들이 직접 수행하게끔 하고, 우리는 stub에 예상 구문(expectation)을 작성하여 SUT의 테스트만 집중하게끔 해야한다(맞나?)</p>
<ol>
<li>필요한 mock(stub) 객체 생성</li>
<li>mock(stub)을 포함한 실제 객체 생성</li>
<li>협력객체가 어떻게 호출될것인지를 기술(행위 검증을 하라는 의미인가?)</li>
<li>SUT에서 협력객체가 포함된 메서드를 호출</li>
<li>예상되는 메서드 호출이 모두 일어났는지 확인</li>
</ol>
<p>모든 테스트 의도를 명확하게 해서 테스트를 거친 기능과 보조 역할을 담당하는 기반 구조, 객체 구조를 분리하는 것?</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/객체를-활용한-테스트-주도-개발/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/tdd/인수테스트-단위테스트-통합테스트-전-구간-테스트/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/tdd/인수테스트-단위테스트-통합테스트-전-구간-테스트/" class="post-title-link" itemprop="url">[tdd] 인수테스트, 단위테스트, 통합테스트, 전 구간 테스트</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-17 11:31:32" itemprop="dateCreated datePublished" datetime="2019-03-17T11:31:32+00:00">2019-03-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/tdd/" itemprop="url" rel="index"><span itemprop="name">tdd</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/tdd/인수테스트-단위테스트-통합테스트-전-구간-테스트/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tdd/인수테스트-단위테스트-통합테스트-전-구간-테스트/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><code>테스트 주도 개발로 배우는 객체지향 설계와 실천</code> 이라는 책과 <a href="http://blog.jonasbandi.net/2010/09/acceptance-vs-integration-tests.html" rel="external nofollow noopener noreferrer" target="_blank">Acceptance Test vs Integration Test</a> 블로그의 글을 합쳐서 작성한 각 테스트들의 종류와 특징이다.</p>
<h1 id="유닛-테스트unit-test"><a class="markdownIt-Anchor" href="#유닛-테스트unit-test"></a> 유닛 테스트(Unit Test)</h1>
<ul>
<li>가장 작은 단위의 테스트이다</li>
<li>보통 메서드 레벨이다</li>
<li>A라는 함수가 실행되면 B라는 결과가 나온다 정도로 테스트한다</li>
<li>즉각적인 피드백이 나온다는 것이 훌륭한 장점이다</li>
<li>꼭 메모리 내에서만 실행되는 테스트여야 한다는 법칙은 없다
<ul>
<li>데이터베이스, 네트워크 엑세스, 파일 시스템 등을 사용하여도 단위테스트의 레벨일 수 있다</li>
</ul>
</li>
<li>테스트하기 어려운 부분은 stub을 사용하여 테스트한다
<ul>
<li>비용이 크지 않다면 stub보다는 실제 객체를 사용하는 것이 좋다</li>
<li>아무래도 정교한 목 객체가 실제 객체보다 정확하지는 않기 때문이다</li>
<li><strong>모든 것은 비용 관점에서 생각해야 한다</strong></li>
</ul>
</li>
<li>하나의 메서드들이 잘 동작한다는 것은 보장할 수 있지만, 그들이 결합되었을때도 잘 작동한다는 것은 보장할 수 없다</li>
</ul>
<h1 id="전-구간-테스트end-to-end-test"><a class="markdownIt-Anchor" href="#전-구간-테스트end-to-end-test"></a> 전 구간 테스트(End-To-End Test)</h1>
<ul>
<li>해당 시스템과 해당 시스템을 구축하고 배포하는 프로세스를 모두 시험하는 것을 말한다
<ul>
<li>용어를 사용하는 곳마다 조금씩 차이가 있다</li>
</ul>
</li>
<li>내부 기능들까지(클래스의 메서드들까지) 테스트 할 필요는 없다
<ul>
<li>이는 단위테스트의 영역이다</li>
</ul>
</li>
<li>단점은 테스트를 만들기가 힘들고, 만든 테스트를 신뢰하기도 힘들다는 것이다</li>
</ul>
<h1 id="통합-테스트integration-test"><a class="markdownIt-Anchor" href="#통합-테스트integration-test"></a> 통합 테스트(Integration Test)</h1>
<ul>
<li>기본적으로 여러개를 통합해서 테스트 할때 사용하는데, 뭔가 정확한 용어가 정의된 느낌은 아니다</li>
<li>책에서는 변경할 수 없는 부분(외부 라이브러리 등)까지 묶어서 같이 테스트 할 떄 사용한다고 말하고 있다</li>
<li>사용하는 곳에서 어떻게 사용하는 가에 따라 다른 것 같다</li>
<li>그래서 난 사용하지 않을 것이다</li>
</ul>
<h1 id="인수-테스트acceptance-test"><a class="markdownIt-Anchor" href="#인수-테스트acceptance-test"></a> 인수 테스트(Acceptance Test)</h1>
<ul>
<li>단위 테스트, 전 구간 테스트, 통합 테스트와는 약간 scope 가 다르다
<ul>
<li>위의 3가지는 초점이 기술 쪽이라면, 인수 테스트는 초점이 비즈니스 쪽이다</li>
</ul>
</li>
<li>구현하고자 하는 기능(비즈니스 레벨)에 대한 테스트이다</li>
<li>대체적으로 전 구간 테스트를 사용하여 기능을 테스트한다
<ul>
<li>그래서 이를 동일하게 얘기하는 곳도 많다</li>
</ul>
</li>
<li>하지만 결과적으론, 위 3가지 모두 인수테스트의 범위에 들어갈 수 있다
<ul>
<li>보험금액을 계산하는 어플리케이션에서는 <code>보험금액을 계산하는 메서드 단위 테스트</code>가 인수테스트가 될 수 있다</li>
</ul>
</li>
</ul>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/tdd/인수테스트-단위테스트-통합테스트-전-구간-테스트/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">JunYoung Park</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">182</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">344</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/feed.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JunYoung Park</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> v3.6.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  
  <script id="dsq-count-scr" src="https://joont92.disqus.com/count.js" async></script>







  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
