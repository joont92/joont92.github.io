<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="@Entity JPA가 관리하는 엔티티가 되기 위해서 필수로 붙여야 하는 어노테이션이다.    속성 기능 기본값     name JPA에서 사용할 엔티티 이름 지정. 중복되는 이름이 있어선 안된다. 클래스 이름 그대로 사용(e.g. Member)    (name은 나중에 JPQL 작성할 때 사용된다.) 엔티티가 될 클래스에는 몇가지 룰이 존재한다.  기본">
<meta name="keywords" content="자바 ORM 표준 JPA 프로그래밍,@Entity,@Table,@Column">
<meta property="og:type" content="article">
<meta property="og:title" content="[jpa] 엔티티 매핑">
<meta property="og:url" content="https://joont92.github.io/jpa/엔티티-매핑/index.html">
<meta property="og:site_name" content="기록은 기억의 연장선">
<meta property="og:description" content="@Entity JPA가 관리하는 엔티티가 되기 위해서 필수로 붙여야 하는 어노테이션이다.    속성 기능 기본값     name JPA에서 사용할 엔티티 이름 지정. 중복되는 이름이 있어선 안된다. 클래스 이름 그대로 사용(e.g. Member)    (name은 나중에 JPQL 작성할 때 사용된다.) 엔티티가 될 클래스에는 몇가지 룰이 존재한다.  기본">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-11-02T10:09:30.457Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[jpa] 엔티티 매핑">
<meta name="twitter:description" content="@Entity JPA가 관리하는 엔티티가 되기 위해서 필수로 붙여야 하는 어노테이션이다.    속성 기능 기본값     name JPA에서 사용할 엔티티 이름 지정. 중복되는 이름이 있어선 안된다. 클래스 이름 그대로 사용(e.g. Member)    (name은 나중에 JPQL 작성할 때 사용된다.) 엔티티가 될 클래스에는 몇가지 룰이 존재한다.  기본">



  <link rel="alternate" href="/feed.xml" title="기록은 기억의 연장선" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://joont92.github.io/jpa/엔티티-매핑/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>[jpa] 엔티티 매핑 | 기록은 기억의 연장선</title>
  




  <script async src="//www.googletagmanager.com/gtag/js?id=UA-110551662-1"></script>
  <script>
    var host = window.location.hostname;
    if (host !== "localhost" || !true) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-110551662-1');
    }
  </script>









  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">기록은 기억의 연장선</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">더 많은 것을 기억하기 위해 기록합니다</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/joont92" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://joont92.github.io/jpa/엔티티-매핑/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JunYoung Park">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="기록은 기억의 연장선">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">[jpa] 엔티티 매핑

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-11-22 00:23:55" itemprop="dateCreated datePublished" datetime="2018-11-22T00:23:55+00:00">2018-11-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2020-11-02 10:09:30" itemprop="dateModified" datetime="2020-11-02T10:09:30+00:00">2020-11-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/jpa/" itemprop="url" rel="index"><span itemprop="name">jpa</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/jpa/엔티티-매핑/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="jpa/엔티티-매핑/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="entity"><a class="markdownIt-Anchor" href="#entity"></a> @Entity</h1>
<p>JPA가 관리하는 엔티티가 되기 위해서 필수로 붙여야 하는 어노테이션이다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">속성</th>
<th style="text-align:left">기능</th>
<th style="text-align:left">기본값</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">JPA에서 사용할 엔티티 이름 지정. 중복되는 이름이 있어선 안된다.</td>
<td style="text-align:left">클래스 이름 그대로 사용(e.g. Member)</td>
</tr>
</tbody>
</table>
<p>(name은 나중에 JPQL 작성할 때 사용된다.)</p>
<p>엔티티가 될 클래스에는 몇가지 룰이 존재한다.</p>
<ul>
<li>기본 생성자 필수(public or protected)</li>
<li>final class, enum, interface, inner class 에는 사용 불가</li>
<li>저장할 필드에 final 사용 불가</li>
</ul>
<blockquote>
<p>이 제약조건은 <code>proxy 패턴, reflection</code>에서 자주 등장하는 용어이다.<br>
proxy 패턴을 사용하려면 대상 클래스를 상속 받아야 하는데, <code>final class, enum, interface, inner class</code>는 상속이 불가능하다.<br>
reflection으로 클래스를 생성할 때, constructor는 대부분 사용하지 않는다.<br>
외부에서는 생성자의 매개변수들이 무엇을 의미하는지 알수가 없기 때문이다.<br>
그러므로 대부분 기본 생성자 + setter를 사용하는데, final은 setter 호출이 불가능하다.</p>
<p>아마 이런 이유일거라고 생각하고, JPA는 결국 proxy 패턴과 reflection을 쓴다는 것을 알 수 있다.<br>
(틀렸을수도 있음)</p>
</blockquote>
<h1 id="table"><a class="markdownIt-Anchor" href="#table"></a> @Table</h1>
<p>엔티티와 매핑할 테이블을 지정할 때 사용한다. 생략하면 엔티티 이름을 테이블 이름으로 사용한다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">속성</th>
<th style="text-align:left">기능</th>
<th style="text-align:left">기본값</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">매핑할 테이블 이름</td>
<td style="text-align:left">엔티티 이름</td>
</tr>
<tr>
<td style="text-align:left">uniqueConstraints(DDL)</td>
<td style="text-align:left">DDL 생성 시에 unique constraints 만듬. 2개 이상의 복합 unique constrains도 가능</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h1 id="기본-키-매핑"><a class="markdownIt-Anchor" href="#기본-키-매핑"></a> 기본 키 매핑</h1>
<p>위에서도 언급했듯이 기본키는 필수값이다.<br>
<code>@Id</code> 어노테이션을 사용해서 지정할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@Column</span>(name=<span class="string">"id"</span>)</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Id</code> 적용 가능한 타입은 아래와 같다.</p>
<ul>
<li>자바 기본형</li>
<li>자바 wrapper형</li>
</ul>
<blockquote>
<p>nullable한 컬럼 때문에 primitive 대신 wrapper를 사용하는 것을 권장(?)한다.<br>
상황에 따라 쓰면되긴 하지만, 알관성을 위해서라도 하나만 쓰는 것이…</p>
</blockquote>
<ul>
<li>String</li>
<li>java.util.Date, java.sql.Date</li>
<li>java.math.BigDecimal, java.math.BigInteger</li>
</ul>
<h2 id="기본키-생성-전략"><a class="markdownIt-Anchor" href="#기본키-생성-전략"></a> 기본키 생성 전략</h2>
<p>엔티티의 기본키를 설정하는 방법에는 크게 <code>직접할당</code>과 <code>자동생성</code>이 있다.<br>
직접할당은 말 그대로 기본키 값을 애플리케이션에서 직접 할당하는 방법이다.<br>
자동생성의 경우 직접할당과 반대로 데이터베이스에 의존하는 방식이다.</p>
<p>자동생성을 사용히려면 기본키 컬럼에 <code>@GeneratedValue 어노테이션 + 전략(strategy)</code>을 지정해줘야 하며, 전략들은 아래와 같다.</p>
<ol>
<li><strong>IDENTITY 전략</strong><br>
MYSQL의 <code>AUTO_INCREMENT</code>와 같다고 보면 된다.<br>
아래와 같이 선언해주면 된다.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
<p>row insert시에 데이터베이스가 자동으로 생성해주는 기본 키 값을 사용하는 방식이다.<br>
이 말인 즉 데이터베이스에 직접 insert 하는 작업이 선행되어야 한다는 뜻이므로,<br>
JPA의 쓰기지연이 동작하지 않는다는 의미이다.</p>
<blockquote>
<p>원래라면 insert 1회 + select 1회(저장된 로우의 기본키 값을 얻어오기 위해)로 2번 튱산해야 하는데,<br>
하이버네이트는 JDBC3 부터 추가된 <code>Statement,getGeneratedKeys()</code>(저장과 동시에 생성된 기본 키 값을 얻어오는 메서드)를 사용함으로써 데이터베이스와 한번만 통신한다(최적화)</p>
</blockquote>
<ol start="2">
<li><strong>SEQUENCE 전략</strong><br>
ORACLE의 SEQUENCE와 같다고 보면 된다.<br>
기본적으로 SEQUENCE가 생성되어 있어야한다. 그리고 아래와 같이 선언해주면 된다.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@SequenceGenerator</span>(</span><br><span class="line">    name = <span class="string">"BOARD_SEQ_GENERATOR"</span>, <span class="comment">// 사용할 sequence 이름</span></span><br><span class="line">    sequenceName = <span class="string">"BOARD_SEQ"</span>, <span class="comment">// 실제 데이터베이스 sequence 이름</span></span><br><span class="line">    initialValue = <span class="number">1</span>, allocationSize = <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Board</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(</span><br><span class="line">        strategy = GenerationType.SEQUENCE,</span><br><span class="line">        generator = <span class="string">"BOARD_SEQ_GENERATOR"</span> <span class="comment">// 위의 sequence 이름</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 id 식별자 값을 얻어올 때 마다 <code>BOARD_SEQ</code> 시퀀스에서 식별자를 조회해오게 된다.<br>
조회한 식별자를 엔티티에 할당한 후, 영속성 컨텍스트에 저장한다.<br>
이후 flush가 발생하면 엔티티를 데이터베이스에 저장한다.<br>
(identity와 달리 insert를 선행할 필요 없어므르 쓰기지연을 사용할 수 있다)<br>
하지만 결과적으로 보면 데이터베이스와 2번 통신하는 셈이다(select 1회 + insert 1회)<br>
<code>@SequenceGenerator</code>를 통해 생성기를 등록해야 한다.</p>
<table>
<thead>
<tr>
<th>속성</th>
<th>기능</th>
<th>기본값</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>식별자 생성기 이름</td>
<td>필수</td>
</tr>
<tr>
<td>sequenceName</td>
<td>데이터베이스에 등록되어 있는 시퀀스 이름</td>
<td>hibernate_sequence</td>
</tr>
<tr>
<td>initialValue</td>
<td>DDL 생성 시에만 사용됨, 시퀀스 DDL을 생성할 때 처음 시작하는 수를 지정한다.</td>
<td>1</td>
</tr>
<tr>
<td>allocationSize</td>
<td>시퀀스 한 번 호출에 증가하는 수(성능 최적화에 사용됨)</td>
<td>50</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><code>initialValue</code>는 sequence 초기값을 설정할 떄 사용하는 옵션인데, 이말인 즉 sequence도 미리 생성해놓지 않으면 자동 생성 가능하다는 것이다(DDL 자동생성을 on 하면 됨)</p>
</li>
<li>
<p><code>allocationSize</code>는 시퀀스 한번 호출에 증가하는 수이다.<br>
default 값이 50인데, 이는 최적화를 위해서이다. 1-50까지의 sequence 값을 한번에 받고 메모리에 저장해서 할당해주다가, 51번째 sequence가 필요할 떄 데이터베이스 sequence에서 51-100의 sequence를 조회해오는 식으로 동작한다.</p>
</li>
</ul>
<ol start="3">
<li><strong>TABLE 전략</strong><br>
sequence를 흉내내는 전략이다. table을 하나 만들어 name과 sequence 값을 저장해둔다.<br>
table을 사용하므로 모든 데이터베이스에서 사용 가능하다. 사용법은 sequence와 거의 동일하다.<br>
<code>@TableGenerator</code>를 통해 생성기를 등록해야 한다.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@TableGenerator</span>(</span><br><span class="line">    name = <span class="string">"MY_BOARD_SEQ_GENERATOR"</span>, <span class="comment">// 사용할 table sequence 이름</span></span><br><span class="line">    table = <span class="string">"MY_BOARD_SEQ"</span>, <span class="comment">// 실제 데이터베이스 table 이름</span></span><br><span class="line">    pkColumnValue = <span class="string">"BOARD_SEQ"</span>, allocationSize = <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Board</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(</span><br><span class="line">        strategy = GenerationType.TABLE,</span><br><span class="line">        generator = <span class="string">"MY_BOARD_SEQ_GENERATOR"</span> <span class="comment">// 위의 sequence 이름</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>기본적으로 테이블은 <code>sequence_name</code>, <code>next_val</code> 의 컬럼을 가진 형태로 생성되고, 로우의 내용은 아래와 같다.<br>
(이름이 맘에 안들면 pkColumnName=XXX, valueColumnName=XXX 의 형태로 지정해주면 된다.)</p>
<table>
<thead>
<tr>
<th style="text-align:left">sequence_name</th>
<th style="text-align:left">next_val</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">BOARD_SEQ</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">MEMBER_SEQ</td>
<td style="text-align:left">7</td>
</tr>
<tr>
<td style="text-align:left">PRODUCT_SEQ</td>
<td style="text-align:left">50</td>
</tr>
</tbody>
</table>
<p>보다시피 하나의 테이블로 관리하므로, <code>pkColumnValue</code>로 어떤 <code>sequence_name</code>을 사용할지 지정해줘야 한다.</p>
<p>참고로 table key는 양이 많아질수록 성능이 급격히 안좋아지므로, 사용하지 않는 것이 좋다.<br>
<a href="https://vladmihalcea.com/why-you-should-never-use-the-table-identifier-generator-with-jpa-and-hibernate/" rel="external nofollow noopener noreferrer" target="_blank">https://vladmihalcea.com/why-you-should-never-use-the-table-identifier-generator-with-jpa-and-hibernate/</a></p>
<ol start="4">
<li><strong>AUTO 전략</strong><br>
선택한 데이터베이스 dialect에 따라 전략(IDENTITY, SEQUENCE, TABLE)을 자동으로 선택해주는 방식이다.<br>
예를 들면 오라클은 SEQUENCE, MYSQL은 IDENTITY가 선택된다.<br>
@GeneratedValue의 기본값은 AUTO이다.</li>
</ol>
<blockquote>
<p>auto_increment랑 sequence를 양쪽 다 지원하는 데이터베이스가 있을 경우(PostgreSQL)<br>
sequence를 우선적으로 선택한다고는 하는데, db마다 다를 수 있을 듯 하다.</p>
</blockquote>
<blockquote>
<p><strong>참고로 @GeneratedValue를 사용한 Id 컬럼에 대해서는 wrapper형을 써주는 것이 좋다.</strong><br>
primitive 타입의 경우 초기화 하지 않을 경우 값이 0인데, 이는 명시적이지 않기 때문이다.<br>
(0으로 세팅한건지, 값이 세팅하지 않은건지 모호함)<br>
물론 기본 auto_increment가 1부터 시작하기 때문에 0일 경우 ORM이 id를 generate 해줘야겠다고 판단하겠지만, 그래도 명시적인게 좋다고 생각한다.<br>
엔티티 모델링에서 boxing/unboxing 비용은 큰 관심사가 아니다.</p>
</blockquote>
<h2 id="식별자-권장-전략"><a class="markdownIt-Anchor" href="#식별자-권장-전략"></a> 식별자 권장 전략</h2>
<p>기본키의 형태는 크게 자연키(비즈니스 의미가 있는 키. e.g. 주민등록번호)<br>
와 대리키(임의로 만들어진 키)가 있는데, 외부풍파에 쉽게 흔들리지 않는 대리키를 사용하는 것아 좋다.<br>
비즈니스라는 것은 내 생각보다 훨씬 쉽게 변하기 때문이다.</p>
<h1 id="필드-매핑"><a class="markdownIt-Anchor" href="#필드-매핑"></a> 필드 매핑</h1>
<h2 id="column"><a class="markdownIt-Anchor" href="#column"></a> @Column</h2>
<p>객체를 필드 테이블에 매핑할 때 사용한다. 가장 많이 사용된다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">속성</th>
<th style="text-align:left">기능</th>
<th style="text-align:left">기본값</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">필드와 테이블 이름 매핑</td>
<td style="text-align:left">객체 필드 이름</td>
</tr>
<tr>
<td style="text-align:left">nullable(DDL)</td>
<td style="text-align:left">null 값 허용 여부. false 설정하면 DDL 생성 시 <code>not null</code>이 붙는다</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">unique(DDL)</td>
<td style="text-align:left">컬럼 하나에 unique constraints 지정할 때 사용. 여러개 지정하려면 @Table의 uniqueConstraints를 사용해야 함</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">length(DDL)</td>
<td style="text-align:left">문자 길이 제약조건. 명시적으로 길이를 볼 수 있는 장점도 있다</td>
<td style="text-align:left">255</td>
</tr>
</tbody>
</table>
<p><code>@Column</code>을 생략해도 엔티티의 필드는 전부 자동으로 테이블과 매핑된다.<br>
이 때 몇가지 특징이 있다.</p>
<ol>
<li>이름은 어떻게 매핑되는가?<br>
@Column의 기본값과 동일하게 컬럼명으로 사용된다. 근데 여기서 딜레마가 하나 있다.<br>
java는 naming을 관례적으로 <code>camel case</code>를 사용하고, database는 naming을 관례적으로 <code>under score</code>를 사용한다는 것이다.<br>
이떄 persistence.xml에</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.ejb.naming_strategy"</span> <span class="attr">value</span>=<span class="string">"org.hibernate.cfg.ImprovedNamingStrategy"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>전략을 주게 되면 위의 딜레마를 해결 가능하다(서로간에 자동 변환)</p>
<ol start="2">
<li>nullable 속성</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> id; <span class="comment">// not null로 생성됨. primitive에는 null이 들어갈 수 없기 때문.</span></span><br><span class="line"></span><br><span class="line">Integer id; <span class="comment">// nullable true로 생성됨</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Column</span></span><br><span class="line"><span class="keyword">int</span> id; <span class="comment">// @Column의 기본값인 nullable=true가 적용되서 nullable=true로 생성됨. 주의해야함</span></span><br></pre></td></tr></table></figure>
<p>보다시피 3번쨰 방법은 nullable=true 임에도 불구하고 null을 넣을 수 없다.<br>
이런 상황을 위해 그냥 primitive 대신 wrapper형을 써주는 것이 좋다.<br>
(not null에는 primitive, nullable에는 wrapper형을 쓸수도 있지만 통일시키지 않아서 오는 불편함이 더 클것이다)</p>
<h2 id="enumerated"><a class="markdownIt-Anchor" href="#enumerated"></a> @Enumerated</h2>
<p>java의 enum 타입을 매핑할 때 사용된다. 유용하게 사용 가능하다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Enumerated</span>(EnumType.STRING)</span><br><span class="line"><span class="keyword">private</span> RoleType roleType;</span><br></pre></td></tr></table></figure>
<p>이렇게 주면 enum의 값 그대로(문자열) 데이터베이스에 저장된다.<br>
ORDINAL을 속성을 사용하면 enum의 순서대로 index가 데이터베이스에 저장되는데,<br>
유연하지 못하므로 STRING 속성을 사용하는 것이 낫다.</p>
<h2 id="temporal"><a class="markdownIt-Anchor" href="#temporal"></a> @Temporal</h2>
<p>날짜 타입을 매핑할 때 사용된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Temporal</span>(TemporalType.DATE)</span><br><span class="line"><span class="keyword">private</span> Date date; <span class="comment">// date date 생성</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Temporal</span>(TemporalType.TIME)</span><br><span class="line"><span class="keyword">private</span> Date time; <span class="comment">// time time 생성</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Temporal</span>(TemporalType.TIMESTAMP)</span><br><span class="line"><span class="keyword">private</span> Date timestamp; <span class="comment">// timestamp timestamp 생성</span></span><br></pre></td></tr></table></figure>
<p>자바의 Date 타입에는 년월일 시분초가 있지만, 데이터베이스에서는 date, time, datetime 3가지 타입이 존재한다.<br>
그러므로 <code>@Temporal</code>을 생략하였을 시, 가장 비슷한 <code>timestamp</code>가 지정된다.<br>
<code>@Temporal</code>은 <code>Date</code>, <code>Calendar</code>에만 붙이는 속성이고,<br>
java8 부터 등장한 <code>LocalDate</code>, <code>LocalTime</code>, <code>LocalDateTime</code>에는 <code>@Temporal</code> 속성을 붙일 수 없다.</p>
<blockquote>
<p>java8 날짜 타입들은 jpa가 바로 인식하지 못하므로 추가적인 조치가 필요하다<br>
<a href="https://homoefficio.github.io/2016/11/19/Spring-Data-JPA-%EC%97%90%EC%84%9C-Java8-Date-Time-JSR-310-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/" rel="external nofollow noopener noreferrer" target="_blank">https://homoefficio.github.io/2016/11/19/Spring-Data-JPA-에서-Java8-Date-Time-JSR-310-사용하기/</a></p>
</blockquote>
<h2 id="lob"><a class="markdownIt-Anchor" href="#lob"></a> @Lob</h2>
<p>BLOB, CLOB 타입에 매핑된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Lob</span></span><br><span class="line">String lob; <span class="comment">// CLOB으로 매핑. mysql에선 longtext로 생성됨</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Lob</span></span><br><span class="line"><span class="keyword">byte</span>[] lob; <span class="comment">// BLOB으로 매핑. mysql에선 longblob으로 생성됨</span></span><br></pre></td></tr></table></figure>
<h2 id="transient"><a class="markdownIt-Anchor" href="#transient"></a> @Transient</h2>
<p>매핑하지 않을 필드에 설정한다. 임의로 값을 보관하고 싶을때 등에 사용한다.</p>
<h2 id="access"><a class="markdownIt-Anchor" href="#access"></a> @Access</h2>
<p>JPA가 엔티티 데이터에 접근하는 방식을 지정한다.<br>
필드 접근: AccessType.FIELD로 지정한다. 필드에 직접 접근한다. 접근 권한이 private이어도 접근할 수 있다.<br>
프로퍼티 접근: AccessType.PROPERTY로 지정한다. Getter를 사용한다.<br>
설정하지 않으면 @id의 위치를 기준으로 접근 방식이 설정된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Access</span>(AccessType.FIELD)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String data1;</span><br><span class="line">    <span class="keyword">private</span> String data2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@id가 필드에 있으므로 @access(AccessType.FIELD)로 설정한 것과 같다. @access 생략가능</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Access</span>(AccessType.PROPERTY)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String data1;</span><br><span class="line">    <span class="keyword">private</span> String data2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getData1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getData2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@id가 프로퍼티에 있으므로, @access 생략가능</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transient</span></span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transient</span></span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String fullName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Access</span>(AccessType.PROPERTY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFullName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> firstName + lastName;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>@id가 필드에 있으므로 기본은 필드 접근 방식 사용, @getFullName()만 프로퍼티 접근방식을 사용한다.<br>
결과적으로 회원 엔티티를 저장하면 회원 테이블의 FULLNAME 컬럼에 firstName + lastName 결과가 저장된다.</p>
<p>@Access를 사용하는 이유<br>
<a href="https://stackoverflow.com/questions/13874528/what-is-the-purpose-of-accesstype-field-accesstype-property-and-access" rel="external nofollow noopener noreferrer" target="_blank">https://stackoverflow.com/questions/13874528/what-is-the-purpose-of-accesstype-field-accesstype-property-and-access</a></p>
<a id="more"></a>
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/자바-ORM-표준-JPA-프로그래밍/" rel="tag"># 자바 ORM 표준 JPA 프로그래밍</a>
          
            <a href="/tags/Entity/" rel="tag"># @Entity</a>
          
            <a href="/tags/Table/" rel="tag"># @Table</a>
          
            <a href="/tags/Column/" rel="tag"># @Column</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/rest/PUT-PATCH의-차이/" rel="next" title="PUT, PATCH의 차이">
                <i class="fa fa-chevron-left"></i> PUT, PATCH의 차이
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/etc/mac-custom-setting/" rel="prev" title="mac custom setting">
                mac custom setting <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">JunYoung Park</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">182</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">344</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/feed.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#entity"><span class="nav-number">1.</span> <span class="nav-text"> @Entity</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#table"><span class="nav-number">2.</span> <span class="nav-text"> @Table</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#기본-키-매핑"><span class="nav-number">3.</span> <span class="nav-text"> 기본 키 매핑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#기본키-생성-전략"><span class="nav-number">3.1.</span> <span class="nav-text"> 기본키 생성 전략</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#식별자-권장-전략"><span class="nav-number">3.2.</span> <span class="nav-text"> 식별자 권장 전략</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#필드-매핑"><span class="nav-number">4.</span> <span class="nav-text"> 필드 매핑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#column"><span class="nav-number">4.1.</span> <span class="nav-text"> @Column</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#enumerated"><span class="nav-number">4.2.</span> <span class="nav-text"> @Enumerated</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#temporal"><span class="nav-number">4.3.</span> <span class="nav-text"> @Temporal</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lob"><span class="nav-number">4.4.</span> <span class="nav-text"> @Lob</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#transient"><span class="nav-number">4.5.</span> <span class="nav-text"> @Transient</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#access"><span class="nav-number">4.6.</span> <span class="nav-text"> @Access</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JunYoung Park</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> v3.6.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">NexT.Muse</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  
  <script id="dsq-count-scr" src="https://joont92.disqus.com/count.js" async></script>


<script>
  var disqus_config = function() {
    this.page.url = "https://joont92.github.io/jpa/엔티티-매핑/";
    this.page.identifier = "jpa/엔티티-매핑/";
    this.page.title = '[jpa] 엔티티 매핑';
    };
  function loadComments() {
    var d = document, s = d.createElement('script');
    s.src = 'https://joont92.disqus.com/embed.js';
    s.setAttribute('data-timestamp', '' + +new Date());
    (d.head || d.body).appendChild(s);
  }
  
    loadComments();
  
</script>





  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
